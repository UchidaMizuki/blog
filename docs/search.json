[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "I am a classical music lover."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "UchidaMizuki",
    "section": "",
    "text": "ioanalysis\n\n\nR\n\n\nJapanese\n\n\n\n\n\n\n\n\n\n\n\nMay 31, 2022\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html",
    "href": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html",
    "title": "ğŸ—¾Rã§ç”£æ¥­é€£é–¢åˆ†æ",
    "section": "",
    "text": "ç”£æ¥­é€£é–¢åˆ†æã¯ï¼ŒçµŒæ¸ˆæ³¢åŠåŠ¹æœã®ç®—å‡ºã«åºƒãç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹åˆ†ææ‰‹æ³•ã§ã™ï¼ æ—¥æœ¬ã§ã¯ï¼Œå›½ã‚„éƒ½é“åºœçœŒã«ã‚ˆã£ã¦ï¼Œç´„5å¹´ã«1åº¦ï¼Œç”£æ¥­é€£é–¢è¡¨ã¨å‘¼ã°ã‚Œã‚‹çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ãŒ ä½œæˆãƒ»å…¬é–‹ã•ã‚Œã¦ãŠã‚Šï¼Œç”£æ¥­é€£é–¢åˆ†æã«ãŠã‘ã‚‹åŸºç¤ãƒ‡ãƒ¼ã‚¿ã¨ãªã£ã¦ã„ã¾ã™ï¼\nã“ã‚Œã¾ã§ï¼Œç”£æ¥­é€£é–¢åˆ†æã§ã¯ï¼ŒExcelãƒ»VBAãŒç”¨ã„ã‚‰ã‚Œã‚‹ã“ã¨ãŒå¤šã‹ã£ãŸã‚ˆã†ã§ã™ï¼\nä¸€æ–¹ã§ï¼Œè¿‘å¹´ã¯ï¼ŒPythonãƒ»Rãƒ»Juliaãªã©ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®æ™®åŠãŒé€²ã‚“ã§ã„ã¾ã™ï¼ ã“ã‚Œã‚‰ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã¯ä»¥ä¸‹ã®ã‚ˆã†ãªç‰¹é•·ã‚’æŒã£ã¦ã„ã¾ã™ï¼\nãã®ãŸã‚ä»Šå¾Œã¯ï¼Œç”£æ¥­é€£é–¢åˆ†æã«ãŠã„ã¦ã‚‚ï¼Œã“ã‚Œã‚‰ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®åˆ©ç”¨ãŒ é€²ã‚€ã®ã§ã¯ãªã„ã‹ã¨æ€ã‚ã‚Œã¾ã™ï¼\nã“ã“ã§ã¯ï¼ŒRã‚’ç”¨ã„ã¦ç”£æ¥­é€£é–¢åˆ†æã‚’è¡Œã„ã¾ã™ï¼ Rã§ã¯è¿‘å¹´ï¼Œtidyverseãªã©ãƒ¢ãƒ€ãƒ³ãªãƒ‡ãƒ¼ã‚¿åˆ†æã‚’è¡Œã†ãŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒ å¤šãæä¾›ã•ã‚Œã¦ãŠã‚Šï¼Œãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°åˆå¿ƒè€…ã§ã‚‚ç¿’å¾—ã—ã‚„ã™ã„è¨€èªã§ã‚ã‚‹ã¨æ€ã„ã¾ã™ï¼\nç”£æ¥­é€£é–¢è¡¨ã¨ã—ã¦ï¼Œe-Statã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§å…¬é–‹ã•ã‚Œã¦ã„ã‚‹æ—¥æœ¬ï¼ˆå›½ï¼‰ã® 2013å¹´ãƒ»13éƒ¨é–€ç”£æ¥­é€£é–¢è¡¨ã‚’ç”¨ã„ã¾ã™ï¼ ã“ã“ã§ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ï¼Œ ã“ã¡ã‚‰ ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ï¼"
  },
  {
    "objectID": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html#ç”£æ¥­é€£é–¢åˆ†æã®åŸºç¤",
    "href": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html#ç”£æ¥­é€£é–¢åˆ†æã®åŸºç¤",
    "title": "ğŸ—¾Rã§ç”£æ¥­é€£é–¢åˆ†æ",
    "section": "ç”£æ¥­é€£é–¢åˆ†æã®åŸºç¤",
    "text": "ç”£æ¥­é€£é–¢åˆ†æã®åŸºç¤\nç”£æ¥­é€£é–¢åˆ†æã¯ä¸€èˆ¬çš„ã«ä»¥ä¸‹ã®æµã‚Œã«å¾“ã£ã¦è¡Œã‚ã‚Œã¾ã™ï¼\n\nç”£æ¥­é€£é–¢è¡¨ã®æ•´å½¢\næŠ•å…¥ä¿‚æ•°è¡Œåˆ—ã®ç®—å‡º\nãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ã®ç®—å‡º\nçµŒæ¸ˆæ³¢åŠåŠ¹æœã®ç®—å‡º\n\nã¾ãšï¼Œç”£æ¥­é€£é–¢åˆ†æã«ãŠã„ã¦é‡è¦ãªæŠ•å…¥ä¿‚æ•°è¡Œåˆ—ãƒ»ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ãƒ»çµŒæ¸ˆæ³¢åŠåŠ¹æœã®ç®—å‡ºæ–¹æ³•ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ï¼\n\næŠ•å…¥ä¿‚æ•°è¡Œåˆ—ã¨ã¯\næŠ•å…¥ä¿‚æ•°ã¯ï¼Œç”£æ¥­ã®ã€Œã‚¯ãƒƒã‚­ãƒ³ã‚°ãƒ¬ã‚·ãƒ”ã€ã¨ã—ã¦å‘¼ã°ã‚Œã¦ãŠã‚Šï¼Œç”£æ¥­\\(j\\)ã®ç”Ÿç”£ç‰©ã‚’1å˜ä½ç”Ÿç”£ã™ã‚‹ã®ã«å¿…è¦ãªç”£æ¥­\\(i\\)ã®ç”Ÿç”£ç‰©ã®é‡ã‚’è¡¨ã™ã‚‚ã®ã§ã™ï¼å…·ä½“çš„ã«ã¯ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ä¸­é–“æŠ•å…¥\\(x_{ij}\\)ã‚’ç”Ÿç”£é¡\\(X_j\\)ï¼ˆç”£å‡ºé¡ï¼‰ã§å‰²ã‚‹ã“ã¨ã§ç®—å‡ºã§ãã¾ã™ï¼\n\\[\na_{ij}=\\frac{x_{ij}}{X_j}\n\\]\nç”£æ¥­é€£é–¢åˆ†æã§ã¯ï¼Œã€Œã‚¯ãƒƒã‚­ãƒ³ã‚°ãƒ¬ã‚·ãƒ”ã€ã«ç›¸å½“ã™ã‚‹æŠ•å…¥ä¿‚æ•°\\(a_{ij}\\)ã«åŸºã¥ãç”Ÿç”£é¡ã®ãƒãƒ©ãƒ³ã‚¹å¼ï¼ˆè¡Œæ–¹å‘ï¼‰ã‚’é€£ç«‹æ–¹ç¨‹å¼ã¨ã—ã¦è§£ãã¾ã™ï¼ãã“ã§ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ï¼ŒæŠ•å…¥ä¿‚æ•°è¡Œåˆ—ï¼ˆé€šå¸¸ï¼Œ\\(A\\)ã¨è¡¨ã•ã‚Œã‚‹ï¼‰ã¨å‘¼ã°ã‚Œã‚‹è¡Œåˆ—ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ï¼Œé€£ç«‹æ–¹ç¨‹å¼ãŒç°¡å˜ã«è§£ã‘ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼\n\\[\nA = \\begin{pmatrix}\n  a_{11} & \\cdots & a_{1n} \\\\\n  \\vdots & \\ddots & \\vdots \\\\\n  a_{n1} & \\cdots & a_{nn} \\\\\n\\end{pmatrix}\n\\]\n\n\nãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ã«ã‚ˆã‚‹çµŒæ¸ˆæ³¢åŠåŠ¹æœã®æ¨è¨ˆã«ã¤ã„ã¦\nç”Ÿç”£é¡ã®ãƒãƒ©ãƒ³ã‚¹å¼ï¼ˆè¡Œæ–¹å‘ï¼‰ã¯ï¼Œè¡Œåˆ—ã‚’ç”¨ã„ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã›ã¾ã™ï¼å¤‰æ•°ã®æ„å‘³ã¯ä»¥ä¸‹ã®è¡¨ã®é€šã‚Šã§ã™ï¼\n\\[\nAX + F + E - M = X\n\\]\n\n\n\nå¤‰æ•°\næ„å‘³\n\n\n\n\n\\(A\\)\næŠ•å…¥ä¿‚æ•°è¡Œåˆ—\n\n\n\\(X = (X_1, \\cdots, X_n) ^ \\top\\)\nç”Ÿç”£é¡ãƒ™ã‚¯ãƒˆãƒ«\n\n\n\\(F = (F_1, \\cdots, F_n) ^ \\top\\)\næœ€çµ‚éœ€è¦ãƒ™ã‚¯ãƒˆãƒ«\n\n\n\\(E = (E_1, \\cdots, E_n) ^ \\top\\)\nç§»è¼¸å‡ºãƒ™ã‚¯ãƒˆãƒ«\n\n\n\\(M = (M_1, \\cdots, M_n) ^ \\top\\)\nç§»è¼¸å…¥ãƒ™ã‚¯ãƒˆãƒ«\n\n\n\nçµŒæ¸ˆæ³¢åŠåŠ¹æœã®æ¨è¨ˆã§ã¯ï¼Œæœ€çµ‚éœ€è¦ã®å¤‰åŒ–ãŒç”Ÿç”£é¡ã«ä¸ãˆã‚‹æ³¢åŠåŠ¹æœã‚’ç®—å‡ºã—ã¾ã™ï¼\nç‰¹ã«ï¼Œæ—¥æœ¬ã®ç”£æ¥­é€£é–¢è¡¨ã§ã®çµŒæ¸ˆæ³¢åŠåŠ¹æœã®æ¨è¨ˆã§ã¯ï¼Œç§»è¼¸å…¥\\(M\\)ã®æ‰±ã„ã«æ³¨æ„ãŒå¿…è¦ã§ã™ï¼ˆã“ã‚Œã¯ï¼Œæ—¥æœ¬è¡¨ã®å¤šããŒç«¶äº‰ç§»è¼¸å…¥å‹è¡¨ã¨å‘¼ã°ã‚Œã‚‹å½¢å¼ã‚’æ¡ç”¨ã—ã¦ãŠã‚Šï¼ŒæŠ•å…¥ä¿‚æ•°ã«ç§»è¼¸å…¥åˆ†ãŒå«ã¾ã‚Œã¦ã„ã‚‹ãŸã‚ã§ã™ï¼‰ï¼\næœ€çµ‚éœ€è¦ã«ã‚ˆã‚‹çµŒæ¸ˆæ³¢åŠåŠ¹æœã¯ï¼ŒåŸŸå†…ã®ç”Ÿç”£é¡ã ã‘ã§ãªãåŸŸå¤–ã‹ã‚‰ã®ç§»è¼¸å…¥ã‚’èª˜ç™ºã™ã‚‹ã¨è€ƒãˆã‚‰ã‚Œã¾ã™ï¼ã“ã®åŠ¹æœã‚’ç„¡è¦–ã™ã‚‹ã¨çµŒæ¸ˆæ³¢åŠåŠ¹æœã‚’éå¤§è©•ä¾¡ã™ã‚‹ã“ã¨ã«ã¤ãªãŒã‚‹ãŸã‚ï¼Œé€šå¸¸ï¼ŒæŠ•å…¥ä¿‚æ•°ã‹ã‚‰ç§»è¼¸å…¥ç›¸å½“åˆ†ã‚’å·®ã—å¼•ãã¨ã„ã†å‡¦ç†ãŒè¡Œã‚ã‚Œã¾ã™ï¼\nç§»è¼¸å…¥ã¯åŸŸå†…éœ€è¦ã«ãŠãŠã‚ˆãæ¯”ä¾‹ã™ã‚‹ã¨è€ƒãˆã‚‰ã‚Œã‚‹ãŸã‚ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ï¼Œç§»è¼¸å…¥ä¿‚æ•°\\(\\hat{M_i}\\)ãŒç®—å‡ºã§ãã¾ã™ï¼\n\\[\n\\hat{M_i} = \\frac{M_i}{\\sum_{j}a_{ij}X_j + F_i}\n\\]\nã•ã‚‰ã«ï¼Œè¡Œåˆ—ã§ã®è¨ˆç®—ã«é©ã—ãŸç§»è¼¸å…¥ä¿‚æ•°è¡Œåˆ—\\(\\hat{M}\\)ãŒï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¾ã™ï¼\n\\[\n\\hat{M} =\n\\begin{pmatrix}\n  \\hat{M_1} & & 0 \\\\\n  & \\ddots & \\\\\n  0 & & \\hat{M_n} \\\\\n\\end{pmatrix}\n\\]\nä»¥ä¸Šã‚ˆã‚Šï¼Œç”Ÿç”£é¡ã®ãƒãƒ©ãƒ³ã‚¹å¼ï¼ˆè¡Œæ–¹å‘ï¼‰ã¯ï¼Œç§»è¼¸å…¥ä¿‚æ•°è¡Œåˆ—\\(\\hat{M}\\)ã‚’ç”¨ã„ã¦ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰å½¢ã•ã‚Œã¾ã™ï¼ãŸã ã—ï¼Œ\\(I\\)ã¯å˜ä½è¡Œåˆ—ï¼ˆå¯¾è§’æˆåˆ†ãŒ1ï¼Œãã‚Œä»¥å¤–ãŒ0ã®æ­£æ–¹è¡Œåˆ—ï¼‰ã§ã™ï¼\n\\[\n\\begin{align}\n  AX + F + E - \\hat{M} (AX + F) &= X \\\\\n  (I - \\hat{M}) (AX + F) + E &= X\n\\end{align}\n\\]\nä¸Šã®ãƒãƒ©ãƒ³ã‚¹å¼ã‚ˆã‚Šï¼ŒçµŒæ¸ˆæ³¢åŠåŠ¹æœã®ç®—å‡ºå¼ãŒï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«å°å‡ºã•ã‚Œã¾ã™ï¼ã“ã“ã§ï¼Œ\\(\\Delta X\\)ï¼Œ\\(\\Delta F\\)ã¯ï¼Œãã‚Œãã‚Œï¼Œç”Ÿç”£é¡ã®å¤‰åŒ–é‡ï¼Œæœ€çµ‚éœ€è¦ã®å¤‰åŒ–é‡ã§ã™ï¼\n\\[\n\\begin{align}\n  X &= (I - \\hat{M}) (AX + F) + E \\\\\n  [I - (I - \\hat{M}) A] X &= (I - \\hat{M}) F + E \\\\\n  X &= [I - (I - \\hat{M}) A] ^ {-1} [(I - \\hat{M}) F + E] \\\\\n  \\Delta X &= [I - (I - \\hat{M}) A] ^ {-1} (I - \\hat{M}) \\Delta F\n\\end{align}\n\\]\nç”Ÿç”£é¡ã®å¤‰åŒ–é‡\\(\\Delta X\\)ã®å¼ã®å³è¾ºã®\\((I - \\hat{M}) \\Delta F\\)ã¯ï¼Œæœ€çµ‚éœ€è¦ã®å¤‰åŒ–é‡ã«è‡ªçµ¦ç‡\\(I - \\hat{M}\\)ã‚’æ›ã‘ãŸå€¤ã¨ãªã£ã¦ã„ã¾ã™ï¼\nã¾ãŸï¼Œ\\([I - (I - \\hat{M}) A] ^ {-1}\\)ã¯ï¼Œæœ€çµ‚éœ€è¦ã®å¤‰åŒ–ã«ã‚ˆã‚‹ç›´æ¥ãƒ»é–“æ¥ã®æ³¢åŠåŠ¹æœã‚’è¡¨ã™è¡Œåˆ—ã§ã‚ã‚Šï¼ˆé–‹æ”¾å‹ã¾ãŸã¯ç«¶äº‰ç§»è¼¸å…¥å‹ã®ï¼‰ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ï¼\nä»¥ä¸Šã®ã‚ˆã†ã«ï¼Œæœ€çµ‚éœ€è¦ã®å¤‰åŒ–é‡\\(\\Delta F\\)ã‹ã‚‰ç”Ÿç”£é¡ã®å¤‰åŒ–é‡\\(\\Delta X\\)ã‚’æ¨è¨ˆã™ã‚‹ã¨ã„ã†ã®ãŒï¼Œæœ€ã‚‚ä¸€èˆ¬çš„ãªç”£æ¥­é€£é–¢åˆ†æã®æ–¹æ³•ã¨ãªã£ã¦ã„ã¾ã™ï¼"
  },
  {
    "objectID": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html#rã«ã‚ˆã‚‹ç”£æ¥­é€£é–¢åˆ†æ",
    "href": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html#rã«ã‚ˆã‚‹ç”£æ¥­é€£é–¢åˆ†æ",
    "title": "ğŸ—¾Rã§ç”£æ¥­é€£é–¢åˆ†æ",
    "section": "Rã«ã‚ˆã‚‹ç”£æ¥­é€£é–¢åˆ†æ",
    "text": "Rã«ã‚ˆã‚‹ç”£æ¥­é€£é–¢åˆ†æ\n\nç”£æ¥­é€£é–¢è¡¨ã®æ•´å½¢\nã“ã“ã§ã¯ï¼Œ ã“ã¡ã‚‰ ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹æ—¥æœ¬ã®2011å¹´ã®3éƒ¨é–€è¡¨ï¼ˆiotable_3sector_2011_wider.csvï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ï¼\nã“ã¡ã‚‰ã®è¡¨ã¯ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ï¼Œæ—¥æœ¬ã®2011å¹´ã®13éƒ¨é–€è¡¨ã‚ˆã‚Šä½œæˆã—ãŸã‚‚ã®ã§ï¼Œå˜ä½ã¯ã€Œç™¾ä¸‡å††ã€ã§ã™ï¼\n\n13éƒ¨é–€ã®ç”£æ¥­åˆ†é¡ã‚’ç¬¬1æ¬¡ãƒ»ç¬¬2æ¬¡ãƒ»ç¬¬3æ¬¡ç”£æ¥­ã«é›†è¨ˆï¼ˆæ³¨ï¼šã€Œåˆ†é¡ä¸æ˜ã€ã‚’ç¬¬3æ¬¡ç”£æ¥­ã«åˆ†é¡ï¼‰\nä»˜åŠ ä¾¡å€¤éƒ¨é–€ã‚’1éƒ¨é–€ã«é›†è¨ˆ\næœ€çµ‚éœ€è¦éƒ¨é–€ã‚’åŸŸå†…æœ€çµ‚éœ€è¦ï¼ˆfinaldemandï¼‰ãƒ»è¼¸å‡ºï¼ˆexportï¼‰ãƒ»è¼¸å…¥ï¼ˆimportï¼‰ã®3éƒ¨é–€ã«é›†è¨ˆ\n\nç”£æ¥­é€£é–¢è¡¨ã®ãƒ‡ãƒ¼ã‚¿å½¢å¼ã¯ï¼Œe-Statã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§æä¾›ã•ã‚Œã¦ã„ã‚‹è¡¨ãªã©ã‚’é™¤ã„ã¦ï¼Œ è¡Œã«æŠ•å…¥éƒ¨é–€ï¼ˆinputï¼‰ãƒ»åˆ—ã«ç”£å‡ºéƒ¨é–€ï¼ˆoutputï¼‰ã‚’æŒã¤ã€Œæ¨ªé•·ãƒ‡ãƒ¼ã‚¿ã€ã§ã‚ã‚‹ã“ã¨ãŒå¤šã„ã¨æ€ã‚ã‚Œã¾ã™ï¼\nã“ã“ã§ã‚‚ï¼Œä»¥ä¸‹ã®é€šã‚Šï¼Œã¾ãšã¯æ¨ªé•·ã®ç”£æ¥­é€£é–¢è¡¨ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã™ï¼\n\nlibrary(tidyverse)\n\niotable_wider <- read_csv(\"iotable_3sector_2011_wider.csv\",\n                          col_types = cols(.default = \"c\")) |> \n  \n  # input (æŠ•å…¥) åˆ—ä»¥å¤–ã‚’æ•°å€¤ã«å¤‰æ›\n  mutate(across(!input, parse_number))\n\nknitr::kable(iotable_wider)\n\n\n\n\n\n\n\n\n\n\n\n\n\ninput\nindustry/01_primary\nindustry/02_secondary\nindustry/03_tertiary\nfinaldemand/04_finaldemand\nexport/05_export\nimport/06_import\n\n\n\n\nindustry/01_primary\n1456611\n7850628\n1373767\n3869875\n47890\n-2562809\n\n\nindustry/02_secondary\n2715710\n161897553\n62841827\n132924323\n54473273\n-71673715\n\n\nindustry/03_tertiary\n2025270\n66811645\n155796589\n352324555\n16423417\n-8921553\n\n\nvalueadded/04_valueadded\n5838371\n106619145\n364447740\nNA\nNA\nNA\n\n\n\n\n\nãƒ‡ãƒ¼ã‚¿åˆ†æã«ãŠã„ã¦ã¯ï¼Œã€Œæ¨ªé•·ãƒ‡ãƒ¼ã‚¿ã€ã‚ˆã‚Šã‚‚ï¼Œä»¥ä¸‹ã®ã‚ˆã†ãªã€Œç¸¦é•·ãƒ‡ãƒ¼ã‚¿ã€ã®ã»ã†ãŒï¼Œ åˆ†æã—ã‚„ã™ã„å ´åˆãŒå¤šãã‚ã‚Šã¾ã™ï¼ ã“ã“ã§ã‚‚ï¼Œæ¨ªé•·ã®ç”£æ¥­é€£é–¢è¡¨ã‚’ã€Œç¸¦é•·ãƒ‡ãƒ¼ã‚¿ã€ã«å¤‰æ›ã—ã¾ã™ï¼\n\niotable <- iotable_wider |>\n  \n  # input (æŠ•å…¥) åˆ—ã‚’åˆ†é¡ãƒ»åç§°ã«åˆ†å‰²\n  separate(input, c(\"input_type\", \"input_name\"),\n           sep = \"/\") |>\n  \n  # input (æŠ•å…¥) ã¨åŒæ§˜ã«output (ç”£å‡º) ã®åˆ†é¡ãƒ»åç§°åˆ—ã‚’è¿½åŠ ã—ç¸¦é•·ãƒ‡ãƒ¼ã‚¿ã«\n  pivot_longer(!c(input_type, input_name),\n               names_to = c(\"output_type\", \"output_name\"),\n               names_sep = \"/\",\n               values_to = \"value_M\") |>\n  \n  # æ•°å€¤ãŒå­˜åœ¨ã—ãªã„è¡Œã‚’å‰Šé™¤\n  drop_na(value_M)\n\nknitr::kable(iotable)\n\n\n\n\ninput_type\ninput_name\noutput_type\noutput_name\nvalue_M\n\n\n\n\nindustry\n01_primary\nindustry\n01_primary\n1456611\n\n\nindustry\n01_primary\nindustry\n02_secondary\n7850628\n\n\nindustry\n01_primary\nindustry\n03_tertiary\n1373767\n\n\nindustry\n01_primary\nfinaldemand\n04_finaldemand\n3869875\n\n\nindustry\n01_primary\nexport\n05_export\n47890\n\n\nindustry\n01_primary\nimport\n06_import\n-2562809\n\n\nindustry\n02_secondary\nindustry\n01_primary\n2715710\n\n\nindustry\n02_secondary\nindustry\n02_secondary\n161897553\n\n\nindustry\n02_secondary\nindustry\n03_tertiary\n62841827\n\n\nindustry\n02_secondary\nfinaldemand\n04_finaldemand\n132924323\n\n\nindustry\n02_secondary\nexport\n05_export\n54473273\n\n\nindustry\n02_secondary\nimport\n06_import\n-71673715\n\n\nindustry\n03_tertiary\nindustry\n01_primary\n2025270\n\n\nindustry\n03_tertiary\nindustry\n02_secondary\n66811645\n\n\nindustry\n03_tertiary\nindustry\n03_tertiary\n155796589\n\n\nindustry\n03_tertiary\nfinaldemand\n04_finaldemand\n352324555\n\n\nindustry\n03_tertiary\nexport\n05_export\n16423417\n\n\nindustry\n03_tertiary\nimport\n06_import\n-8921553\n\n\nvalueadded\n04_valueadded\nindustry\n01_primary\n5838371\n\n\nvalueadded\n04_valueadded\nindustry\n02_secondary\n106619145\n\n\nvalueadded\n04_valueadded\nindustry\n03_tertiary\n364447740\n\n\n\n\n\nä¸Šã§æ§‹ç¯‰ã—ãŸè¡¨ãƒ‡ãƒ¼ã‚¿ã¯ï¼Œå„è¡Œã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãªã©ãŒå®¹æ˜“ã«ã§ãã‚‹ä¸€æ–¹ã§ï¼Œ ç”£æ¥­é€£é–¢åˆ†æã«ç”¨ã„ã‚‰ã‚Œã‚‹è¡Œåˆ—è¨ˆç®—ãªã©ã«é©ã—ã¦ã„ã¾ã›ã‚“ï¼\nãã“ã§ï¼Œè¡¨ãƒ‡ãƒ¼ã‚¿ã®åŸºæœ¬çš„ãªæ¼”ç®—ã¨è¡Œåˆ—è¨ˆç®—ã‚’åŒæ™‚ã«è¡Œãˆã‚‹dibbleãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ã¾ã™ï¼ ä»¥ä¸‹ã®ã‚ˆã†ã«ï¼Œç”£æ¥­é€£é–¢è¡¨ã‚’dibbleã«å¤‰æ›ã—ã¾ã™ï¼\n\n# pak::pak(\"UchidaMizuki/dibble\")\nlibrary(dibble)\n\niotable <- iotable |>\n  dibble_by(input = c(input_type, input_name),\n            output = c(output_type, output_name),\n            \n            # \"_\"ã§åˆ—åã‚’åˆ†å‰²ã—ã¦input (æŠ•å…¥)ãƒ»output (ç”£å‡º) è»¸ã‚’è¨­å®š\n            .names_sep = \"_\")\n\niotable\n\n# A dibble:   24 x 1\n# Dimensions: input [4], output [6]\n# Measures:   value_M\n   input$type $name        output$type $name            value_M\n   <chr>      <chr>        <chr>       <chr>              <dbl>\n 1 industry   01_primary   industry    01_primary       1456611\n 2 industry   01_primary   industry    02_secondary     7850628\n 3 industry   01_primary   industry    03_tertiary      1373767\n 4 industry   01_primary   finaldemand 04_finaldemand   3869875\n 5 industry   01_primary   export      05_export          47890\n 6 industry   01_primary   import      06_import       -2562809\n 7 industry   02_secondary industry    01_primary       2715710\n 8 industry   02_secondary industry    02_secondary   161897553\n 9 industry   02_secondary industry    03_tertiary     62841827\n10 industry   02_secondary finaldemand 04_finaldemand 132924323\n# â€¦ with 14 more rows\n\n\n\n\næŠ•å…¥ä¿‚æ•°è¡Œåˆ—ã®ç®—å‡º\nç”£æ¥­ã®ã€Œã‚¯ãƒƒã‚­ãƒ³ã‚°ãƒ¬ã‚·ãƒ”ã€ã¨å‘¼ã°ã‚Œã‚‹æŠ•å…¥ä¿‚æ•°è¡Œåˆ—\\(A\\)ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ä¸­é–“æŠ•å…¥ã‚’ç”Ÿç”£é¡ã§å‰²ã£ã¦ç®—å‡ºã—ã¾ã™ï¼\næ³¨ï¼šdibbleã§ã¯ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆãŒè‡ªå‹•ã§è¡Œã‚ã‚Œã¾ã™ãŒï¼Œå®‰å…¨ã®ãŸã‚ï¼Œãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆã‚’è¡Œã†éš›ã«ï¼Œè­¦å‘Šã‚’ç™ºã™ã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ï¼ãã®ãŸã‚ï¼Œbroadcast()ã§ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆå¾Œã®è»¸åc(\"input\", \"output\")ã‚’ä¸ãˆã¦è­¦å‘ŠãŒå‡ºãªã„ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼\n\n# ç”Ÿç”£é¡\ntotal_input <- iotable |>\n  filter(output$type == \"industry\") |>\n  apply(\"output\", sum)\n\n# ä¸­é–“æŠ•å…¥\ninterindustry <- iotable |>\n  filter(input$type == \"industry\",\n         output$type == \"industry\")\n\n# æŠ•å…¥ä¿‚æ•°\ninput_coeff <- broadcast(interindustry / total_input,\n                         c(\"input\", \"output\"))\n\ninput_coeff\n\n# A dibble:   9\n# Dimensions: input [3], output [3]\n  input$type $name        output$type $name              .\n  <chr>      <chr>        <chr>       <chr>          <dbl>\n1 industry   01_primary   industry    01_primary   0.121  \n2 industry   01_primary   industry    02_secondary 0.0229 \n3 industry   01_primary   industry    03_tertiary  0.00235\n4 industry   02_secondary industry    01_primary   0.226  \n5 industry   02_secondary industry    02_secondary 0.472  \n6 industry   02_secondary industry    03_tertiary  0.108  \n7 industry   03_tertiary  industry    01_primary   0.168  \n8 industry   03_tertiary  industry    02_secondary 0.195  \n9 industry   03_tertiary  industry    03_tertiary  0.267  \n\n\n\n\nãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ã®ç®—å‡º\nçµŒæ¸ˆæ³¢åŠåŠ¹æœã‚’è¡¨ã™ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ï¼Œç§»è¼¸å…¥ä¿‚æ•°ã¨æŠ•å…¥ä¿‚æ•°ã‚’ç”¨ã„ã¦ç®—å‡ºã§ãã¾ã™ï¼\næ³¨ï¼šsolve()ã§é€†è¡Œåˆ—ã‚’ç®—å‡ºã™ã‚‹ã¨è¡Œåˆ—ã®è»¸åãŒå…¥ã‚Œæ›¿ã‚ã‚‹ãŸã‚æ³¨æ„ã—ã¦ãã ã•ã„ï¼\n\n# åŸŸå†…éœ€è¦\nlocal_demand <- iotable |>\n  filter(input$type == \"industry\",\n         !output$type %in% c(\"export\", \"import\")) |>\n  apply(\"input\", sum)\n\n# (ç§») è¼¸å…¥\nimport <- iotable |>\n  filter(input$type == \"industry\",\n         output$type == \"import\") |>\n  apply(\"input\", sum)\n# ç¬¦å·ã‚’æ­£ã«\nimport <- -import\n\n# (ç§») è¼¸å…¥ä¿‚æ•°\nimport_coeff <- import / local_demand\n\nI <- eye(input_coeff) # å˜ä½è¡Œåˆ—\nM <- import_coeff     # ç§»è¼¸å…¥ä¿‚æ•°ãƒ™ã‚¯ãƒˆãƒ« (broadcastãŒè¡Œã‚ã‚Œã‚‹ãŸã‚è¡Œåˆ—ã§ãªãã¦ã‚ˆã„)\nA <- input_coeff      # æŠ•å…¥ä¿‚æ•°è¡Œåˆ—\n\n# ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—\nleontiefinv <- broadcast(I - (1 - M) * A,\n                         c(\"input\", \"output\")) |>\n  solve()\n\nleontiefinv\n\n# A dibble:   9\n# Dimensions: output [3], input [3]\n  output$type $name        input$type $name              .\n  <chr>       <chr>        <chr>      <chr>          <dbl>\n1 industry    01_primary   industry   01_primary   1.12   \n2 industry    01_primary   industry   02_secondary 0.0361 \n3 industry    01_primary   industry   03_tertiary  0.00716\n4 industry    02_secondary industry   01_primary   0.374  \n5 industry    02_secondary industry   02_secondary 1.68   \n6 industry    02_secondary industry   03_tertiary  0.197  \n7 industry    03_tertiary  industry   01_primary   0.348  \n8 industry    03_tertiary  industry   02_secondary 0.445  \n9 industry    03_tertiary  industry   03_tertiary  1.41   \n\n\n\n\nçµŒæ¸ˆæ³¢åŠåŠ¹æœã®ç®—å‡º\nã“ã¡ã‚‰ ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹æœ€çµ‚éœ€è¦ãŒãã‚Œãã‚Œç™¾ä¸‡å††ãšã¤å¢—åŠ ã™ã‚‹ï¼ˆfinaldemand_change_3sector.csvï¼‰ã‚±ãƒ¼ã‚¹ã§çµŒæ¸ˆæ³¢åŠåŠ¹æœã‚’ç®—å‡ºã—ã¦ã„ã¾ã™ï¼\n\n# æœ€çµ‚éœ€è¦å¤‰åŒ–é‡\nfinaldemand_change <- read_csv(\"finaldemand_change_3sector.csv\",\n                               col_types = cols(.default = \"c\",\n                                                value_M = \"n\")) |> \n  dibble_by(input = c(input_type, input_name),\n            .names_sep = \"_\")\n\nL <- leontiefinv         # ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—\nM <- import_coeff        # ç§»è¼¸å…¥ä¿‚æ•°\nFD <- finaldemand_change # æœ€çµ‚éœ€è¦å¤‰åŒ–é‡\n\n# çµŒæ¸ˆæ³¢åŠåŠ¹æœ\nspillover <- L %*% ((1 - M) * FD)\n\nspillover\n\n# A dibble:   3\n# Dimensions: output [3]\n  output$type $name            .\n  <chr>       <chr>        <dbl>\n1 industry    01_primary   0.958\n2 industry    02_secondary 1.85 \n3 industry    03_tertiary  2.03 \n\nspillover |> \n  as_tibble(n = \"value_M\") |> \n  unpack(output, \"_\") |> \n  ggplot(aes(output_name, value_M)) +\n  geom_col()"
  },
  {
    "objectID": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html#ã¾ã¨ã‚",
    "href": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html#ã¾ã¨ã‚",
    "title": "ğŸ—¾Rã§ç”£æ¥­é€£é–¢åˆ†æ",
    "section": "ã¾ã¨ã‚",
    "text": "ã¾ã¨ã‚\nRã‚’ç”¨ã„ãŸç”£æ¥­é€£é–¢åˆ†æã®æ–¹æ³•ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã—ãŸï¼\nã“ã“ã¾ã§ã®è¨ˆç®—ã‚’ï¼Œjpioã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å½¢å¼ã§ã¾ã¨ã‚ã¾ã—ãŸï¼ä»¥ä¸‹ã®ã‚ˆã†ã«ï¼Œã“ã“ã¾ã§ã®è¨ˆç®—ã¨åŒæ§˜ã®è¨ˆç®—ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ï¼\n\n# pak::pak(\"UchidaMizuki/jpio\")\n\n# ç”£æ¥­é€£é–¢è¡¨\niotable <- read_csv(\"iotable_3sector_2011.csv\",\n                    col_types = cols(.default = \"c\",\n                                     value_M = \"n\")) |> \n  jpio::as_iotable()\n\niotable\n\n# A dibble:   24\n# Dimensions: input [4], output [6]\n   input$type $name        output$type $name                  .\n   <fct>      <chr>        <fct>       <chr>              <dbl>\n 1 industry   01_primary   industry    01_primary       1456611\n 2 industry   01_primary   industry    02_secondary     7850628\n 3 industry   01_primary   industry    03_tertiary      1373767\n 4 industry   01_primary   finaldemand 04_finaldemand   3869875\n 5 industry   01_primary   export      05_export          47890\n 6 industry   01_primary   import      06_import       -2562809\n 7 industry   02_secondary industry    01_primary       2715710\n 8 industry   02_secondary industry    02_secondary   161897553\n 9 industry   02_secondary industry    03_tertiary     62841827\n10 industry   02_secondary finaldemand 04_finaldemand 132924323\n# â€¦ with 14 more rows\n\n# æŠ•å…¥ä¿‚æ•°\njpio::input_coeff(iotable)\n\n# A dibble:   9\n# Dimensions: input [3], output [3]\n  input$type $name        output$type $name              .\n  <fct>      <chr>        <fct>       <chr>          <dbl>\n1 industry   01_primary   industry    01_primary   0.121  \n2 industry   01_primary   industry    02_secondary 0.0229 \n3 industry   01_primary   industry    03_tertiary  0.00235\n4 industry   02_secondary industry    01_primary   0.226  \n5 industry   02_secondary industry    02_secondary 0.472  \n6 industry   02_secondary industry    03_tertiary  0.108  \n7 industry   03_tertiary  industry    01_primary   0.168  \n8 industry   03_tertiary  industry    02_secondary 0.195  \n9 industry   03_tertiary  industry    03_tertiary  0.267  \n\n# ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—\njpio::leontief_inv(iotable)\n\n# A dibble:   9\n# Dimensions: output [3], input [3]\n  output$type $name        input$type $name              .\n  <fct>       <chr>        <fct>      <chr>          <dbl>\n1 industry    01_primary   industry   01_primary   1.12   \n2 industry    01_primary   industry   02_secondary 0.0361 \n3 industry    01_primary   industry   03_tertiary  0.00716\n4 industry    02_secondary industry   01_primary   0.374  \n5 industry    02_secondary industry   02_secondary 1.68   \n6 industry    02_secondary industry   03_tertiary  0.197  \n7 industry    03_tertiary  industry   01_primary   0.348  \n8 industry    03_tertiary  industry   02_secondary 0.445  \n9 industry    03_tertiary  industry   03_tertiary  1.41   \n\n# çµŒæ¸ˆæ³¢åŠåŠ¹æœ\njpio::spillover_effect(iotable,\n                       list(`01_primary` = 1,\n                            `02_secondary` = 1,\n                            `03_tertiary` = 1))\n\n# A dibble:   3\n# Dimensions: output [3]\n  output$type $name            .\n  <fct>       <chr>        <dbl>\n1 industry    01_primary   0.958\n2 industry    02_secondary 1.85 \n3 industry    03_tertiary  2.03"
  }
]