[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "My name is Uchida Mizuki.\nI am a classical music lover."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "UchidaMizuki",
    "section": "",
    "text": "Rã§æ—¥æœ¬ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹ç‡çš„ã«å–å¾—ã—ã‚ˆã†ï¼ˆe-Stat APIã¨jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ï¼‰\n\n\n\n\n\n\n\ne-Stat\n\n\njpstat\n\n\nR\n\n\nJapanese\n\n\n\n\n\n\n\n\n\n\n\nDec 12, 2022\n\n\n\n\n\n\n  \n\n\n\n\nğŸ—¾CSVã®ä»£ã‚ã‚Šã«Parquetã‚’ä½¿ã£ã¦ã¿ã‚ˆã†\n\n\n\n\n\n\n\nparquet\n\n\narrow\n\n\nR\n\n\nPython\n\n\nJapanese\n\n\n\n\n\n\n\n\n\n\n\nJun 12, 2022\n\n\n\n\n\n\n  \n\n\n\n\nğŸ—¾Rã§æ—¥æœ¬åœ°å›³ã‚’æã„ã¦ã¿ã‚ˆã†\n\n\n\n\n\n\n\nggplot2\n\n\nsf\n\n\njpmap\n\n\nR\n\n\nJapanese\n\n\n\n\n\n\n\n\n\n\n\nJun 11, 2022\n\n\n\n\n\n\n  \n\n\n\n\nğŸ—¾Rã§åœ°åŸŸãƒ¡ãƒƒã‚·ãƒ¥çµ±è¨ˆï¼ˆjpgridãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰\n\n\n\n\n\n\n\ngrid-square-stats\n\n\njpgrid\n\n\nR\n\n\nJapanese\n\n\n\n\n\n\n\n\n\n\n\nJun 4, 2022\n\n\n\n\n\n\n  \n\n\n\n\nğŸ—¾Rã§ç”£æ¥­é€£é–¢åˆ†æ\n\n\n\n\n\n\n\nioanalysis\n\n\ndibble\n\n\nR\n\n\nJapanese\n\n\n\n\n\n\n\n\n\n\n\nMay 31, 2022\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/draw-a-map-of-japan-in-r-ja/draw-a-map-of-japan-in-r-ja.html",
    "href": "posts/draw-a-map-of-japan-in-r-ja/draw-a-map-of-japan-in-r-ja.html",
    "title": "ğŸ—¾Rã§æ—¥æœ¬åœ°å›³ã‚’æã„ã¦ã¿ã‚ˆã†",
    "section": "",
    "text": "Rã§ã¯ï¼Œggplot2ãªã©ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’åˆ©ç”¨ã™ã‚‹ã ã‘ã§ï¼Œãã‚Œã„ãªæ—¥æœ¬åœ°å›³ï¼ˆéƒ½é“åºœçœŒåˆ¥ï¼‰ã‚’æãã“ã¨ãŒã§ãã¾ã™ï¼\nã“ã“ã§ã¯ï¼Œæ—¥æœ¬åœ°å›³ã‚’ggplot2ã§æç”»ã™ã‚‹æ–¹æ³•ã‚’ã„ãã¤ã‹ç´¹ä»‹ã—ã¾ã™ï¼"
  },
  {
    "objectID": "posts/draw-a-map-of-japan-in-r-ja/draw-a-map-of-japan-in-r-ja.html#åœ°å›³æç”»ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿",
    "href": "posts/draw-a-map-of-japan-in-r-ja/draw-a-map-of-japan-in-r-ja.html#åœ°å›³æç”»ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿",
    "title": "ğŸ—¾Rã§æ—¥æœ¬åœ°å›³ã‚’æã„ã¦ã¿ã‚ˆã†",
    "section": "åœ°å›³æç”»ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿",
    "text": "åœ°å›³æç”»ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿\nã“ã“ã§ã¯ï¼Œã“ã¡ã‚‰ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ç¤¾ä¼šãƒ»äººå£çµ±è¨ˆä½“ç³»ã®2015å¹´ã®éƒ½é“åºœçœŒåˆ¥å¤–å›½äººäººå£æ¯”ç‡ãƒ‡ãƒ¼ã‚¿ï¼ˆ10ä¸‡äººã‚ãŸã‚Šå¤–å›½äººäººå£ï¼‰ã‚’åœ°å›³æç”»ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¾ã—ãŸï¼\n\nlibrary(tidyverse)\n\nãƒ‡ãƒ¼ã‚¿ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\n\n\nã‚³ãƒ¼ãƒ‰\nlibrary(jpstat)\nlibrary(arrow)\n\nappId <- keyring::key_get(\"estat-api\")\nforeigner_ratio_2015 <- estat(appId, \"https://www.e-stat.go.jp/en/dbview?sid=0000010201\",\n                              lang = \"E\")\nforeigner_ratio_2015 <- foreigner_ratio_2015 |> \n  activate(tab) |> \n  select() |> \n  \n  activate(cat01) |> \n  # Ratio of population of foreigners (per 100,000 persons)\n  filter(code == \"#A01601\") |> \n  select() |> \n  \n  activate(area) |> \n  filter(name != \"All Japan\") |> \n  select(code, name) |> \n  rekey(\"pref\") |> \n  \n  activate(time) |> \n  filter(name == \"2015\") |> \n  select()\nforeigner_ratio_2015 <- foreigner_ratio_2015 |> \n  collect(\"foreigners_per_100K\")\n\nwrite_parquet(foreigner_ratio_2015, \"foreigner_ratio_2015.parquet\")\n\n\nãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿\n\n\nã‚³ãƒ¼ãƒ‰\nlibrary(arrow)\n\nforeigner_ratio_2015 <- read_parquet(\"foreigner_ratio_2015.parquet\") |> \n  mutate(pref_code = pref_code |> \n           str_extract(\"^\\\\d{2}\") |> \n           parse_integer(),\n         \n         pref_name = pref_name |> \n           str_remove(\"-.+$\"),\n         pref_name = case_when(pref_name == \"Gumma\" ~ \"Gunma\",\n                               TRUE ~ pref_name),\n         \n         foreigner_ratio = parse_number(foreigners_per_100K) / 1e5,\n         .keep = \"unused\")\n\n\n\nforeigner_ratio_2015\n\n# A tibble: 47 Ã— 3\n   pref_code pref_name foreigner_ratio\n       <int> <chr>               <dbl>\n 1         1 Hokkaido          0.00403\n 2         2 Aomori            0.00264\n 3         3 Iwate             0.00392\n 4         4 Miyagi            0.00599\n 5         5 Akita             0.00285\n 6         6 Yamagata          0.00490\n 7         7 Fukushima         0.00456\n 8         8 Ibaraki           0.0142 \n 9         9 Tochigi           0.0134 \n10        10 Gunma             0.0188 \n# â€¦ with 37 more rows"
  },
  {
    "objectID": "posts/draw-a-map-of-japan-in-r-ja/draw-a-map-of-japan-in-r-ja.html#geom_map-ã‚’ä½¿ã£ã¦æ—¥æœ¬åœ°å›³ã‚’æã",
    "href": "posts/draw-a-map-of-japan-in-r-ja/draw-a-map-of-japan-in-r-ja.html#geom_map-ã‚’ä½¿ã£ã¦æ—¥æœ¬åœ°å›³ã‚’æã",
    "title": "ğŸ—¾Rã§æ—¥æœ¬åœ°å›³ã‚’æã„ã¦ã¿ã‚ˆã†",
    "section": "geom_map() ã‚’ä½¿ã£ã¦æ—¥æœ¬åœ°å›³ã‚’æã",
    "text": "geom_map() ã‚’ä½¿ã£ã¦æ—¥æœ¬åœ°å›³ã‚’æã\nggplot2ã§ã¯ï¼Œmap_data() ã‚„geom_map() ã‚’ä½¿ã†ã“ã¨ã§ï¼Œä¸–ç•Œã®å›½ã€…ã‚’æç”»ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ã“ã‚Œã«ã¯ï¼Œmapsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’äºˆã‚ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ã¾ãŸï¼Œæ—¥æœ¬åœ°å›³ã‚’åˆ©ç”¨ã™ã‚‹ã«ã¯ï¼Œmapsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«åŠ ãˆã¦ï¼Œmapdataãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå¿…è¦ã«ãªã‚Šã¾ã™ï¼\nmap_data(\"japan\") ã¨ã™ã‚‹ã“ã¨ã§ï¼Œmapsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®åœ°å›³ãƒ‡ãƒ¼ã‚¿ãŒãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«å¤‰æ›ã•ã‚Œã¾ã™ï¼ã“ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã®region åˆ—ãŒéƒ½é“åºœçœŒã®IDã¨ãªã‚‹ãŸã‚ï¼Œaes(map_id = region)ã‚’è¨­å®šã—ãŸä¸Šã§ï¼Œgeom_map() ã™ã‚‹ã“ã¨ã§ï¼Œæç”»ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã®region åˆ—ã¨éƒ½é“åºœçœŒã‚¸ã‚ªãƒ¡ãƒˆãƒªãŒãƒªãƒ³ã‚¯ã—ã¾ã™ï¼\nãŸã ã—ï¼Œmap_data(\"japan\") ã¯ï¼Œä»¥ä¸‹ã®ç‚¹ã«æ³¨æ„ãŒå¿…è¦ã§ã™ï¼\n\nregion åˆ—ã¯ã™ã¹ã¦ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆè¡¨è¨˜ã§ã‚ã‚‹\nä»–ã®éƒ½é“åºœçœŒã¨é•ã„ï¼Œå¥ˆè‰¯çœŒã ã‘ãŒãŒNARA ã¨å¤§æ–‡å­—è¡¨è¨˜ã«ãªã£ã¦ã„ã‚‹ãªã©ï¼Œå…ƒãƒ‡ãƒ¼ã‚¿ã«å•é¡Œã‚ã‚Š\n\nã“ã“ã§ã¯ï¼Œstr_to_title()ã§ä¿®æ­£\n\n\nã¾ãŸï¼Œæ—¥æœ¬åœ°å›³å…¨ä½“ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã«ã¯ï¼Œexpand_limits() ãªã©ã§è»¸ã‚’è¨­å®šã™ã‚‹ã“ã¨å¿…è¦ã«ãªã‚Šã¾ã™ï¼\n\n# pak::pak(\"maps\")\n# pak::pak(\"mapdata\")\nlibrary(tidyverse)\nlibrary(mapdata)\n\nmap_data_japan <- map_data(\"japan\") |> \n  as_tibble() |> \n  mutate(region = str_to_title(region))\nmap_data_japan\n\n# A tibble: 46,975 Ã— 6\n    long   lat group order region   subregion\n   <dbl> <dbl> <dbl> <int> <chr>    <chr>    \n 1  140.  42.3     1     1 Hokkaido <NA>     \n 2  140.  42.3     1     2 Hokkaido <NA>     \n 3  140.  42.3     1     3 Hokkaido <NA>     \n 4  140.  42.3     1     4 Hokkaido <NA>     \n 5  140.  42.3     1     5 Hokkaido <NA>     \n 6  140.  42.3     1     6 Hokkaido <NA>     \n 7  140.  42.3     1     7 Hokkaido <NA>     \n 8  140.  42.3     1     8 Hokkaido <NA>     \n 9  140.  42.3     1     9 Hokkaido <NA>     \n10  140.  42.3     1    10 Hokkaido <NA>     \n# â€¦ with 46,965 more rows\n\nggplot(foreigner_ratio_2015 |> \n         rename(region = pref_name),\n       aes(map_id = region)) +\n  geom_map(aes(fill = foreigner_ratio),\n           map = map_data_japan) +\n  expand_limits(x = map_data_japan$long,\n                y = map_data_japan$lat) +\n  scale_fill_viridis_c(\"å¤–å›½äººäººå£æ¯”ç‡\",\n                       limits = c(0, 0.03),\n                       labels = scales::label_percent(),\n                       option = \"turbo\")"
  },
  {
    "objectID": "posts/draw-a-map-of-japan-in-r-ja/draw-a-map-of-japan-in-r-ja.html#sfãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦æ—¥æœ¬åœ°å›³ã‚’æã",
    "href": "posts/draw-a-map-of-japan-in-r-ja/draw-a-map-of-japan-in-r-ja.html#sfãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦æ—¥æœ¬åœ°å›³ã‚’æã",
    "title": "ğŸ—¾Rã§æ—¥æœ¬åœ°å›³ã‚’æã„ã¦ã¿ã‚ˆã†",
    "section": "sfãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦æ—¥æœ¬åœ°å›³ã‚’æã",
    "text": "sfãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦æ—¥æœ¬åœ°å›³ã‚’æã\næœ€è¿‘ã§ã¯ï¼Œsfãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¸ã‚ªãƒ¡ãƒˆãƒªãŒggplot2ã§ç°¡å˜ã«æç”»ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ï¼\nã¾ãŸï¼Œmapsãƒ»mapdataãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®æä¾›ã™ã‚‹åœ°å›³ãƒ‡ãƒ¼ã‚¿ã¯ï¼Œsfãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®st_as_sf() ã§sfã®ã‚¸ã‚ªãƒ¡ãƒˆãƒªãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼\næ—¥æœ¬åœ°å›³ãƒ‡ãƒ¼ã‚¿ã‚’sfã«å¤‰æ›ã™ã‚‹ã“ã¨ã§ï¼Œå…ˆã»ã©ã‚ˆã‚Šã‚‚ç›´æ„Ÿçš„ã«åœ°å›³ã‚’æãã“ã¨ãŒã§ãã¾ã™ï¼\n\nlibrary(sf)\n\nLinking to GEOS 3.9.1, GDAL 3.3.2, PROJ 7.2.1; sf_use_s2() is TRUE\n\nmap_japan <- maps::map(\"japan\", \n                       plot = FALSE,\n                       fill = TRUE) |> \n  st_as_sf() |> \n  rename(pref_name = ID) |> \n  mutate(pref_name = str_to_title(pref_name))\n\nmap_japan |> \n  left_join(foreigner_ratio_2015,\n            by = \"pref_name\") |> \n  ggplot(aes(fill = foreigner_ratio)) +\n  geom_sf(color = \"transparent\") +\n  scale_fill_viridis_c(\"å¤–å›½äººäººå£æ¯”ç‡\",\n                       limits = c(0, 0.03),\n                       labels = scales::label_percent(),\n                       option = \"turbo\")"
  },
  {
    "objectID": "posts/draw-a-map-of-japan-in-r-ja/draw-a-map-of-japan-in-r-ja.html#ã‚‚ã£ã¨ç°¡å˜ã«æ—¥æœ¬åœ°å›³ã‚’æã",
    "href": "posts/draw-a-map-of-japan-in-r-ja/draw-a-map-of-japan-in-r-ja.html#ã‚‚ã£ã¨ç°¡å˜ã«æ—¥æœ¬åœ°å›³ã‚’æã",
    "title": "ğŸ—¾Rã§æ—¥æœ¬åœ°å›³ã‚’æã„ã¦ã¿ã‚ˆã†",
    "section": "ã‚‚ã£ã¨ç°¡å˜ã«æ—¥æœ¬åœ°å›³ã‚’æã",
    "text": "ã‚‚ã£ã¨ç°¡å˜ã«æ—¥æœ¬åœ°å›³ã‚’æã\njpmapã¯ï¼Œggplot2ã«ã‚ˆã‚‹æ—¥æœ¬åœ°å›³ã®æç”»ã‚’ã‚ˆã‚Šç°¡å˜ã«ã™ã‚‹ãŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã™ï¼\njpmapã¯ï¼Œä»¥ä¸‹ã®2ã¤ã®æ©Ÿèƒ½ã‚’æŒã¡ã¾ã™ï¼\n\næ—¥æœ¬èªã®éƒ½é“åºœçœŒåã‚„éƒ½é“åºœçœŒã‚³ãƒ¼ãƒ‰ãŒå«ã‚€éƒ½é“åºœçœŒãƒ‡ãƒ¼ã‚¿ã‚’æä¾›ï¼ˆjpmap::prefectureï¼‰\nç‰çƒè«¸å³¶ãƒ»å°ç¬ åŸè«¸å³¶ã‚’å†é…ç½®ã—ãŸãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’å¯èƒ½ã«ï¼ˆjpmap::layout_islands()ï¼‰\n\njpmap::layout_islands() ã§åœ°å›³ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§ï¼Œéƒ½é“åºœçœŒã”ã¨ã®å‚¾å‘ãŒã‚ˆã‚Šã‚ã‹ã‚Šã‚„ã™ããªã‚Šã¾ã™ï¼\n\n# pak::pak(\"UchidaMizuki/jpmap\")\njpmap::prefecture\n\nSimple feature collection with 47 features and 3 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 122.935 ymin: 24.0433 xmax: 148.8678 ymax: 45.5386\nGeodetic CRS:  WGS 84\n# A tibble: 47 Ã— 4\n   pref_code pref_name pref_name_ja                                         geom\n       <int> <chr>     <chr>                                  <MULTIPOLYGON [Â°]>\n 1         1 Hokkaido  åŒ—æµ·é“       (((145.2498 43.6126, 145.1639 43.6385, 145.â€¦\n 2         2 Aomori    é’æ£®çœŒ       (((139.8692 40.5863, 139.8745 40.5802, 139.â€¦\n 3         3 Iwate     å²©æ‰‹çœŒ       (((140.6595 39.3864, 140.6785 39.3829, 140.â€¦\n 4         4 Miyagi    å®®åŸçœŒ       (((141.0347 38.2792, 141.0384 38.2868, 141.â€¦\n 5         5 Akita     ç§‹ç”°çœŒ       (((139.8725 39.1156, 139.9496 39.1106, 139.â€¦\n 6         6 Yamagata  å±±å½¢çœŒ       (((139.5506 38.5498, 139.5527 38.5508, 139.â€¦\n 7         7 Fukushima ç¦å³¶çœŒ       (((139.208 37.1909, 139.2164 37.1969, 139.2â€¦\n 8         8 Ibaraki   èŒ¨åŸçœŒ       (((139.6911 36.1965, 139.6988 36.1541, 139.â€¦\n 9         9 Tochigi   æ ƒæœ¨çœŒ       (((139.3358 36.6239, 139.3489 36.6227, 139.â€¦\n10        10 Gunma     ç¾¤é¦¬çœŒ       (((138.4448 36.4195, 138.4606 36.4156, 138.â€¦\n# â€¦ with 37 more rows\n\nplot <- jpmap::prefecture |> \n  left_join(foreigner_ratio_2015,\n            by = c(\"pref_code\", \"pref_name\")) |> \n  ggplot(aes(fill = foreigner_ratio)) +\n  geom_sf(color = \"transparent\") +\n  scale_fill_viridis_c(\"å¤–å›½äººäººå£æ¯”ç‡\",\n                       limits = c(0, 0.03),\n                       labels = scales::label_percent(),\n                       option = \"turbo\")\n\njpmap::layout_islands(plot,\n                      ogasawara = FALSE)"
  },
  {
    "objectID": "posts/draw-a-map-of-japan-in-r-ja/draw-a-map-of-japan-in-r-ja.html#ã¾ã¨ã‚åœ°å›³ã‹ã‚‰ã‚ã‹ã£ãŸã“ã¨",
    "href": "posts/draw-a-map-of-japan-in-r-ja/draw-a-map-of-japan-in-r-ja.html#ã¾ã¨ã‚åœ°å›³ã‹ã‚‰ã‚ã‹ã£ãŸã“ã¨",
    "title": "ğŸ—¾Rã§æ—¥æœ¬åœ°å›³ã‚’æã„ã¦ã¿ã‚ˆã†",
    "section": "ã¾ã¨ã‚ï¼ˆåœ°å›³ã‹ã‚‰ã‚ã‹ã£ãŸã“ã¨ï¼‰",
    "text": "ã¾ã¨ã‚ï¼ˆåœ°å›³ã‹ã‚‰ã‚ã‹ã£ãŸã“ã¨ï¼‰\n2015å¹´ã®éƒ½é“åºœçœŒåˆ¥å¤–å›½äººäººå£æ¯”ç‡ã«é–¢ã™ã‚‹æ—¥æœ¬åœ°å›³ã‹ã‚‰ä»¥ä¸‹ã®ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸï¼\n\n2015å¹´ã§ã¯ã©ã®éƒ½é“åºœçœŒã§ã‚‚å¤–å›½äººäººå£æ¯”ç‡ãŒ3ï¼…ä»¥ä¸‹ã§ã‚ã‚‹\næ±äº¬éƒ½ã¯å¤–å›½äººäººå£æ¯”ç‡ãŒæœ€ã‚‚å¤šãï¼Œæ„›çŸ¥çœŒã‚„ç¾¤é¦¬çœŒãªã©ã‚‚å¤–å›½äººå£æ¯”ç‡ãŒé«˜ã„ï¼\n\nã“ã“ã¾ã§ï¼Œggplot2ãªã©ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’æ´»ç”¨ã—ãŸæ—¥æœ¬åœ°å›³ã®æç”»ã‚’è©¦ã—ã¦ã¿ã¾ã—ãŸï¼\nãã®çµæœï¼ŒRã‚’ä½¿ãˆã°ï¼Œè‡ªå‰ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ•´å‚™ã—ãªãã¦ã‚‚ï¼Œç°¡å˜ã«æ—¥æœ¬åœ°å›³ã‚’æã‘ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã—ãŸï¼ã¿ãªã•ã‚“ã‚‚ãœã²ï¼Œggplot2ã‚’ä½¿ã£ã¦ï¼Œè‰²ã€…ãªåœ°å›³ã‚’ä½¿ã£ã¦ã¿ã¦ãã ã•ã„ï¼"
  },
  {
    "objectID": "posts/grid-square-stats-in-r-ja/grid-square-stats-in-r-ja.html",
    "href": "posts/grid-square-stats-in-r-ja/grid-square-stats-in-r-ja.html",
    "title": "ğŸ—¾Rã§åœ°åŸŸãƒ¡ãƒƒã‚·ãƒ¥çµ±è¨ˆï¼ˆjpgridãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰",
    "section": "",
    "text": "åœ°åŸŸãƒ¡ãƒƒã‚·ãƒ¥ï¼ˆGrid Squaresï¼‰ã¨ã¯ã€Œç·¯åº¦ãƒ»çµŒåº¦ã«åŸºã¥ã„ã¦æ—¥æœ¬ã®å›½åœŸã‚’ã»ã¼æ­£æ–¹å½¢ã®åŒºç”»ã«åˆ†å‰²ã—ãŸã‚‚ã®ã€ã§ï¼Œç´„80 kmå››æ–¹ï½ç´„100 må››æ–¹ãªã©æ§˜ã€…ãªå¤§ãã•ã®ãƒ¡ãƒƒã‚·ãƒ¥ã«å¯¾ã—ã¦ãã‚Œãã‚Œãƒ¡ãƒƒã‚·ãƒ¥ã‚³ãƒ¼ãƒ‰ãŒå‰²ã‚ŠæŒ¯ã‚‰ã‚Œã¦ã„ã¾ã™ï¼\nã“ã‚Œã‚‰ã®ãƒ¡ãƒƒã‚·ãƒ¥ã‚³ãƒ¼ãƒ‰ã«çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’å¯¾å¿œã•ã›ãŸãƒ‡ãƒ¼ã‚¿ã¯åœ°åŸŸãƒ¡ãƒƒã‚·ãƒ¥çµ±è¨ˆã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ï¼\nã“ã“ã§ã¯ï¼Œåœ°åŸŸãƒ¡ãƒƒã‚·ãƒ¥ã‚’æ‰±ã†ãŸã‚ã®Rãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã‚ã‚‹jpgridã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ç´¹ä»‹ã—ã¾ã™ï¼\nä½¿ç”¨ã—ãŸã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã¯ï¼Œã“ã¡ã‚‰ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ï¼"
  },
  {
    "objectID": "posts/grid-square-stats-in-r-ja/grid-square-stats-in-r-ja.html#æ±äº¬ã®ä¸»è¦é§…å‘¨è¾ºã®ãƒ¡ãƒƒã‚·ãƒ¥äººå£",
    "href": "posts/grid-square-stats-in-r-ja/grid-square-stats-in-r-ja.html#æ±äº¬ã®ä¸»è¦é§…å‘¨è¾ºã®ãƒ¡ãƒƒã‚·ãƒ¥äººå£",
    "title": "ğŸ—¾Rã§åœ°åŸŸãƒ¡ãƒƒã‚·ãƒ¥çµ±è¨ˆï¼ˆjpgridãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰",
    "section": "æ±äº¬ã®ä¸»è¦é§…å‘¨è¾ºã®ãƒ¡ãƒƒã‚·ãƒ¥äººå£",
    "text": "æ±äº¬ã®ä¸»è¦é§…å‘¨è¾ºã®ãƒ¡ãƒƒã‚·ãƒ¥äººå£\næ±äº¬ã®ä¸»è¦é§…å‘¨è¾ºã®ãƒ¡ãƒƒã‚·ãƒ¥äººå£ã‚’å›³ç¤ºã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼ã“ã“ã§ã¯ï¼Œé§…ã®ä½ç½®ãƒ‡ãƒ¼ã‚¿ï¼ˆstation_5339_2019.gpkgï¼‰ã¨500 mãƒ¡ãƒƒã‚·ãƒ¥äººå£ãƒ‡ãƒ¼ã‚¿ï¼ˆpop_grid500m_5339_2015ï¼‰ã‚’åˆ©ç”¨ã—ã¾ã™ï¼\nï¼»ãƒ‡ãƒ¼ã‚¿å‡ºå…¸ï¼½\n\nstation_5339_2019.gpkgï¼šå›½åœŸæ•°å€¤æƒ…å ±ã®2019å¹´é‰„é“ãƒ‡ãƒ¼ã‚¿ã‚ˆã‚Šä½œæˆï¼ˆ80 kmãƒ¡ãƒƒã‚·ãƒ¥ï¼š5339ã®ã¿ï¼‰\npop_grid500m_5339_2015.parquetï¼šåœ°å›³ã§è¦‹ã‚‹çµ±è¨ˆã®2015å¹´å›½å‹¢èª¿æŸ»ã®4æ¬¡ãƒ¡ãƒƒã‚·ãƒ¥ãƒ‡ãƒ¼ã‚¿ã‚ˆã‚Šä½œæˆ\n\n\né§…ã®ä½ç½®ãƒ‡ãƒ¼ã‚¿\nstation_5339_2019.gpkg ã«ã¯æ±äº¬éƒ½è¿‘è¾ºï¼ˆ80 kmãƒ¡ãƒƒã‚·ãƒ¥ï¼š5339ï¼‰ã®2019å¹´ã®é§…ãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã¦ã„ã¾ã™ï¼\n\n# pak::pak(\"UchidaMizuki/jpgrid\")\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(arrow)\nlibrary(jpgrid)\n\n# crs\nWGS84 <- 4326\n\n# ggspatial\nannotation_map_tile <- function(zoomin = -1, \n                                progress = \"none\", ...) {\n  list(ggspatial::annotation_map_tile(zoomin = zoomin, \n                                      progress = progress, ...),\n       labs(caption = \"Â© OpenStreetMap contributors\"))\n}\n\nstation <- read_sf(\"station_5339_2019.gpkg\")\n\nggplot(station,\n       aes(color = line)) +\n  annotation_map_tile() +\n  geom_sf(show.legend = FALSE) +\n  scale_color_viridis_d(option = \"turbo\")\n\n\n\n\n\n\næ±äº¬ä¸»è¦é§…ã®500 mãƒ¡ãƒƒã‚·ãƒ¥é§…å‹¢åœã®ä½œæˆ\næ±äº¬ã®ä¸»è¦é§…ã§ã‚ã‚‹æ–°å®¿é§…ãƒ»æ¸‹è°·é§…ãƒ»æ± è¢‹é§…ãƒ»æ±äº¬é§…ã®4ã¤ã®é§…ã«å¯¾ã—ã¦ï¼Œ500 mãƒ¡ãƒƒã‚·ãƒ¥ã§é§…å‹¢åœã‚’ä½œæˆã—ã¦ã¿ã¾ã™ï¼ã“ã“ã§ã¯ï¼Œé§…ã®ä»£è¡¨ç‚¹ã‹ã‚‰ç´„1.5 kmã‚’é§…å‹¢åœã¨ã—ã¾ã™ï¼\njpgridã§ã¯ï¼Œgeometry_to_grid() ã§sfãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¸ã‚ªãƒ¡ãƒˆãƒªã‚’ãƒ¡ãƒƒã‚·ãƒ¥ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ã¾ãŸï¼Œé€†ã«ï¼Œgrid_as_sf() ã§ãƒ¡ãƒƒã‚·ãƒ¥ã‚³ãƒ¼ãƒ‰ã‚’æŒã¤ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’sfãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¸ã‚ªãƒ¡ãƒˆãƒªãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼\n\n# é§…å‹¢åœã®è·é›¢\ndist_station <- units::set_units(1.5, km)\n\n# ä¸»è¦é§…ã®ä»£è¡¨ç‚¹ã‚’ä¸­å¿ƒã¨ã™ã‚‹é§…å‹¢åœã‚¸ã‚ªãƒ¡ãƒˆãƒª\nstation_main <- station |>\n  filter(station %in% c(\"æ–°å®¿\", \"æ¸‹è°·\", \"æ± è¢‹\", \"æ±äº¬\")) |>\n  group_by(station = as_factor(station)) |>\n  summarise(.groups = \"drop\") |>\n  \n  # é‡å¿ƒç‚¹ã‚’ä½œæˆ\n  st_centroid() |>\n  \n  # é‡å¿ƒç‚¹ã‚’ä¸­å¿ƒã¨ã™ã‚‹å††ã‚’ä½œæˆ\n  st_buffer(dist_station)\n\n# é§…å‹¢åœã®500 mãƒ¡ãƒƒã‚·ãƒ¥ãƒ‡ãƒ¼ã‚¿\nstation_main_grid500m <- station_main |>\n  mutate(grid500m = geom |>\n           \n           # sfã‚¸ã‚ªãƒ¡ãƒˆãƒª -> 500 mãƒ¡ãƒƒã‚·ãƒ¥\n           geometry_to_grid(\"500m\")) |>\n  st_drop_geometry() |>\n  unnest(grid500m) |>\n  \n  # 500 mãƒ¡ãƒƒã‚·ãƒ¥ -> sfã‚¸ã‚ªãƒ¡ãƒˆãƒª\n  grid_as_sf(crs = WGS84)\n\nggplot(station_main,\n       aes(fill = station,\n           label = station)) +\n  annotation_map_tile() +\n  geom_sf(data = station_main_grid500m,\n          alpha = 0.5) +\n  geom_sf(fill = \"transparent\",\n          linetype = \"dashed\") +\n  geom_sf_text() +\n  scale_fill_brewer(palette = \"Set2\") +\n  theme(legend.position = \"none\")"
  },
  {
    "objectID": "posts/grid-square-stats-in-r-ja/grid-square-stats-in-r-ja.html#æ±äº¬ä¸»è¦é§…ã®é§…å‹¢åœã«ãŠã‘ã‚‹ãƒ¡ãƒƒã‚·ãƒ¥äººå£",
    "href": "posts/grid-square-stats-in-r-ja/grid-square-stats-in-r-ja.html#æ±äº¬ä¸»è¦é§…ã®é§…å‹¢åœã«ãŠã‘ã‚‹ãƒ¡ãƒƒã‚·ãƒ¥äººå£",
    "title": "ğŸ—¾Rã§åœ°åŸŸãƒ¡ãƒƒã‚·ãƒ¥çµ±è¨ˆï¼ˆjpgridãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰",
    "section": "æ±äº¬ä¸»è¦é§…ã®é§…å‹¢åœã«ãŠã‘ã‚‹ãƒ¡ãƒƒã‚·ãƒ¥äººå£",
    "text": "æ±äº¬ä¸»è¦é§…ã®é§…å‹¢åœã«ãŠã‘ã‚‹ãƒ¡ãƒƒã‚·ãƒ¥äººå£\næ±äº¬ã®ä¸»è¦é§…ã®é§…å‹¢åœã«ãŠã‘ã‚‹2015å¹´ã®ãƒ¡ãƒƒã‚·ãƒ¥äººå£ï¼ˆpop_grid500m_5339_2015.parquetï¼‰ã‚’å›³ç¤ºã—ã¦ã¿ã¾ã™ï¼grid_500m() ãªã©ã®é–¢æ•°ã‚’ç”¨ã„ã‚‹ã“ã¨ã§æ–‡å­—åˆ—ã®ãƒ¡ãƒƒã‚·ãƒ¥ã‚³ãƒ¼ãƒ‰ï¼ˆ\"533900054\"ãªã©ï¼‰ã‚’jpgridã®ãƒ¡ãƒƒã‚·ãƒ¥ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›ã§ãã¾ã™ï¼\nã‚°ãƒ©ãƒ•ã‚ˆã‚Šä»¥ä¸‹ã®ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸï¼\n\n4ã¤ã®é§…ã®é§…å‹¢åœäººå£ã¯æ± è¢‹é§…ã§æœ€ã‚‚å¤šãæ±äº¬é§…ã§æœ€ã‚‚å°‘ãªã„\né§…ã‚„çš‡å±…ãƒ»å…¬åœ’ãªã©ã®å‘¨è¾ºã§äººå£ãŒå°‘ãªã„ã“ã¨ãŒåœ°å›³ã‹ã‚‰ã‚‚ç¢ºèªã§ãã‚‹\n\n\n# 500 mãƒ¡ãƒƒã‚·ãƒ¥äººå£\npop_grid500m <- read_parquet(\"pop_grid500m_5339_2015.parquet\") |> \n  mutate(grid500m = grid_500m(grid500m))\n\n# 500 mãƒ¡ãƒƒã‚·ãƒ¥é§…å‹¢åœãƒ‡ãƒ¼ã‚¿ã«äººå£ã‚’ä»˜ä¸\nstation_main_grid500m <- station_main_grid500m |> \n  left_join(pop_grid500m,\n            by = \"grid500m\") |> \n  replace_na(list(pop = 0))\n\nlimits <- c(0, max(station_main_grid500m$pop))\n\nstation_main_grid500m |> \n  group_by(station) |> \n  group_map(~ {\n    ggplot(.x,\n           aes(fill = pop)) +\n      annotation_map_tile() +\n      geom_sf(alpha = 0.5) +\n      scale_fill_viridis_c(\"äººå£\",\n                           limits = limits,\n                           option = \"turbo\") +\n      ggtitle(.y$station) +\n      theme(plot.title = element_text(hjust = 0.5),\n            axis.text = element_blank())\n  }) |> \n  patchwork::wrap_plots() +\n  patchwork::plot_layout(guides = \"collect\")\n\n\n\n\n\nstation_main_grid500m |> \n  st_drop_geometry() |> \n  group_by(station) |> \n  summarise(pop = sum(pop)) |> \n  ggplot(aes(station, pop)) +\n  geom_col(aes(fill = station),\n           show.legend = FALSE) +\n  geom_text(aes(label = scales::label_comma(suffix = \"äºº\")(pop)),\n            vjust = 2) +\n  scale_x_discrete(\"æ±äº¬ã®ä¸»è¦é§…\") +\n  scale_y_continuous(\"é§…å‹¢åœãƒ¡ãƒƒã‚·ãƒ¥äººå£ [åƒäºº]\",\n                     labels = scales::label_comma(scale = 1e-3)) +\n  scale_fill_brewer(palette = \"Set2\")"
  },
  {
    "objectID": "posts/grid-square-stats-in-r-ja/grid-square-stats-in-r-ja.html#ã¾ã¨ã‚",
    "href": "posts/grid-square-stats-in-r-ja/grid-square-stats-in-r-ja.html#ã¾ã¨ã‚",
    "title": "ğŸ—¾Rã§åœ°åŸŸãƒ¡ãƒƒã‚·ãƒ¥çµ±è¨ˆï¼ˆjpgridãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼‰",
    "section": "ã¾ã¨ã‚",
    "text": "ã¾ã¨ã‚\nRãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®jpgridã«ã‚ˆã‚‹åœ°åŸŸãƒ¡ãƒƒã‚·ãƒ¥çµ±è¨ˆã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’ç´¹ä»‹ã—ã¾ã—ãŸï¼\njpgridã‚’ä½¿ã†ã“ã¨ã§ï¼Œç·¯åº¦çµŒåº¦ã‚„ã‚¸ã‚ªãƒ¡ãƒˆãƒªã®ãƒ‡ãƒ¼ã‚¿ã‚’ç°¡å˜ã«åœ°åŸŸãƒ¡ãƒƒã‚·ãƒ¥çµ±è¨ˆã¨ç´ã¥ã‘ã‚‰ã‚Œã¾ã™ï¼çš†ã•ã‚“ã‚‚ãœã²ä½¿ã£ã¦ã¿ã¦ãã ã•ã„ï¼"
  },
  {
    "objectID": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html",
    "href": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html",
    "title": "ğŸ—¾Rã§ç”£æ¥­é€£é–¢åˆ†æ",
    "section": "",
    "text": "ç”£æ¥­é€£é–¢åˆ†æã¯ï¼ŒçµŒæ¸ˆæ³¢åŠåŠ¹æœã®ç®—å‡ºã«åºƒãç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹åˆ†ææ‰‹æ³•ã§ã™ï¼ æ—¥æœ¬ã§ã¯ï¼Œå›½ã‚„éƒ½é“åºœçœŒã«ã‚ˆã£ã¦ï¼Œç´„5å¹´ã«1åº¦ï¼Œç”£æ¥­é€£é–¢è¡¨ã¨å‘¼ã°ã‚Œã‚‹çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ãŒ ä½œæˆãƒ»å…¬é–‹ã•ã‚Œã¦ãŠã‚Šï¼Œç”£æ¥­é€£é–¢åˆ†æã«ãŠã‘ã‚‹åŸºç¤ãƒ‡ãƒ¼ã‚¿ã¨ãªã£ã¦ã„ã¾ã™ï¼\nã“ã‚Œã¾ã§ï¼Œç”£æ¥­é€£é–¢åˆ†æã§ã¯ï¼ŒExcelãƒ»VBAãŒç”¨ã„ã‚‰ã‚Œã‚‹ã“ã¨ãŒå¤šã‹ã£ãŸã‚ˆã†ã§ã™ï¼\nä¸€æ–¹ã§ï¼Œè¿‘å¹´ã¯ï¼ŒPythonãƒ»Rãƒ»Juliaãªã©ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®æ™®åŠãŒé€²ã‚“ã§ã„ã¾ã™ï¼ ã“ã‚Œã‚‰ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã¯ä»¥ä¸‹ã®ã‚ˆã†ãªç‰¹é•·ã‚’æŒã£ã¦ã„ã¾ã™ï¼\nãã®ãŸã‚ä»Šå¾Œã¯ï¼Œç”£æ¥­é€£é–¢åˆ†æã«ãŠã„ã¦ã‚‚ï¼Œã“ã‚Œã‚‰ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®åˆ©ç”¨ãŒ é€²ã‚€ã®ã§ã¯ãªã„ã‹ã¨æ€ã‚ã‚Œã¾ã™ï¼\nã“ã“ã§ã¯ï¼ŒRã‚’ç”¨ã„ã¦ç”£æ¥­é€£é–¢åˆ†æã‚’è¡Œã„ã¾ã™ï¼ Rã§ã¯è¿‘å¹´ï¼Œtidyverseãªã©ãƒ¢ãƒ€ãƒ³ãªãƒ‡ãƒ¼ã‚¿åˆ†æã‚’è¡Œã†ãŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒ å¤šãæä¾›ã•ã‚Œã¦ãŠã‚Šï¼Œãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°åˆå¿ƒè€…ã§ã‚‚ç¿’å¾—ã—ã‚„ã™ã„è¨€èªã§ã‚ã‚‹ã¨æ€ã„ã¾ã™ï¼\nç”£æ¥­é€£é–¢è¡¨ã¨ã—ã¦ï¼Œe-Statã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§å…¬é–‹ã•ã‚Œã¦ã„ã‚‹æ—¥æœ¬ï¼ˆå›½ï¼‰ã® 2013å¹´ãƒ»13éƒ¨é–€ç”£æ¥­é€£é–¢è¡¨ã‚’ç”¨ã„ã¾ã™ï¼ ã“ã“ã§ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ï¼Œ ã“ã¡ã‚‰ ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ï¼"
  },
  {
    "objectID": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html#ç”£æ¥­é€£é–¢åˆ†æã®åŸºç¤",
    "href": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html#ç”£æ¥­é€£é–¢åˆ†æã®åŸºç¤",
    "title": "ğŸ—¾Rã§ç”£æ¥­é€£é–¢åˆ†æ",
    "section": "ç”£æ¥­é€£é–¢åˆ†æã®åŸºç¤",
    "text": "ç”£æ¥­é€£é–¢åˆ†æã®åŸºç¤\nç”£æ¥­é€£é–¢åˆ†æã¯ä¸€èˆ¬çš„ã«ä»¥ä¸‹ã®æµã‚Œã«å¾“ã£ã¦è¡Œã‚ã‚Œã¾ã™ï¼\n\nç”£æ¥­é€£é–¢è¡¨ã®æ•´å½¢\næŠ•å…¥ä¿‚æ•°è¡Œåˆ—ã®ç®—å‡º\nãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ã®ç®—å‡º\nçµŒæ¸ˆæ³¢åŠåŠ¹æœã®ç®—å‡º\n\nã¾ãšï¼Œç”£æ¥­é€£é–¢åˆ†æã«ãŠã„ã¦é‡è¦ãªæŠ•å…¥ä¿‚æ•°è¡Œåˆ—ãƒ»ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ãƒ»çµŒæ¸ˆæ³¢åŠåŠ¹æœã®ç®—å‡ºæ–¹æ³•ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ï¼\n\næŠ•å…¥ä¿‚æ•°è¡Œåˆ—ã¨ã¯\næŠ•å…¥ä¿‚æ•°ã¯ï¼Œç”£æ¥­ã®ã€Œã‚¯ãƒƒã‚­ãƒ³ã‚°ãƒ¬ã‚·ãƒ”ã€ã¨ã—ã¦å‘¼ã°ã‚Œã¦ãŠã‚Šï¼Œç”£æ¥­\\(j\\)ã®ç”Ÿç”£ç‰©ã‚’1å˜ä½ç”Ÿç”£ã™ã‚‹ã®ã«å¿…è¦ãªç”£æ¥­\\(i\\)ã®ç”Ÿç”£ç‰©ã®é‡ã‚’è¡¨ã™ã‚‚ã®ã§ã™ï¼å…·ä½“çš„ã«ã¯ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ä¸­é–“æŠ•å…¥\\(x_{ij}\\)ã‚’ç”Ÿç”£é¡\\(X_j\\)ï¼ˆç”£å‡ºé¡ï¼‰ã§å‰²ã‚‹ã“ã¨ã§ç®—å‡ºã§ãã¾ã™ï¼\n\\[\na_{ij}=\\frac{x_{ij}}{X_j}\n\\]\nç”£æ¥­é€£é–¢åˆ†æã§ã¯ï¼Œã€Œã‚¯ãƒƒã‚­ãƒ³ã‚°ãƒ¬ã‚·ãƒ”ã€ã«ç›¸å½“ã™ã‚‹æŠ•å…¥ä¿‚æ•°\\(a_{ij}\\)ã«åŸºã¥ãç”Ÿç”£é¡ã®ãƒãƒ©ãƒ³ã‚¹å¼ï¼ˆè¡Œæ–¹å‘ï¼‰ã‚’é€£ç«‹æ–¹ç¨‹å¼ã¨ã—ã¦è§£ãã¾ã™ï¼ãã“ã§ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ï¼ŒæŠ•å…¥ä¿‚æ•°è¡Œåˆ—ï¼ˆé€šå¸¸ï¼Œ\\(A\\)ã¨è¡¨ã•ã‚Œã‚‹ï¼‰ã¨å‘¼ã°ã‚Œã‚‹è¡Œåˆ—ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ï¼Œé€£ç«‹æ–¹ç¨‹å¼ãŒç°¡å˜ã«è§£ã‘ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼\n\\[\nA = \\begin{pmatrix}\n  a_{11} & \\cdots & a_{1n} \\\\\n  \\vdots & \\ddots & \\vdots \\\\\n  a_{n1} & \\cdots & a_{nn} \\\\\n\\end{pmatrix}\n\\]\n\n\nãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ã«ã‚ˆã‚‹çµŒæ¸ˆæ³¢åŠåŠ¹æœã®æ¨è¨ˆã«ã¤ã„ã¦\nç”Ÿç”£é¡ã®ãƒãƒ©ãƒ³ã‚¹å¼ï¼ˆè¡Œæ–¹å‘ï¼‰ã¯ï¼Œè¡Œåˆ—ã‚’ç”¨ã„ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã›ã¾ã™ï¼å¤‰æ•°ã®æ„å‘³ã¯ä»¥ä¸‹ã®è¡¨ã®é€šã‚Šã§ã™ï¼\n\\[\nAX + F + E - M = X\n\\]\n\n\n\nå¤‰æ•°\næ„å‘³\n\n\n\n\n\\(A\\)\næŠ•å…¥ä¿‚æ•°è¡Œåˆ—\n\n\n\\(X = (X_1, \\cdots, X_n) ^ \\top\\)\nç”Ÿç”£é¡ãƒ™ã‚¯ãƒˆãƒ«\n\n\n\\(F = (F_1, \\cdots, F_n) ^ \\top\\)\næœ€çµ‚éœ€è¦ãƒ™ã‚¯ãƒˆãƒ«\n\n\n\\(E = (E_1, \\cdots, E_n) ^ \\top\\)\nç§»è¼¸å‡ºãƒ™ã‚¯ãƒˆãƒ«\n\n\n\\(M = (M_1, \\cdots, M_n) ^ \\top\\)\nç§»è¼¸å…¥ãƒ™ã‚¯ãƒˆãƒ«\n\n\n\nçµŒæ¸ˆæ³¢åŠåŠ¹æœã®æ¨è¨ˆã§ã¯ï¼Œæœ€çµ‚éœ€è¦ã®å¤‰åŒ–ãŒç”Ÿç”£é¡ã«ä¸ãˆã‚‹æ³¢åŠåŠ¹æœã‚’ç®—å‡ºã—ã¾ã™ï¼\nç‰¹ã«ï¼Œæ—¥æœ¬ã®ç”£æ¥­é€£é–¢è¡¨ã§ã®çµŒæ¸ˆæ³¢åŠåŠ¹æœã®æ¨è¨ˆã§ã¯ï¼Œç§»è¼¸å…¥\\(M\\)ã®æ‰±ã„ã«æ³¨æ„ãŒå¿…è¦ã§ã™ï¼ˆã“ã‚Œã¯ï¼Œæ—¥æœ¬è¡¨ã®å¤šããŒç«¶äº‰ç§»è¼¸å…¥å‹è¡¨ã¨å‘¼ã°ã‚Œã‚‹å½¢å¼ã‚’æ¡ç”¨ã—ã¦ãŠã‚Šï¼ŒæŠ•å…¥ä¿‚æ•°ã«ç§»è¼¸å…¥åˆ†ãŒå«ã¾ã‚Œã¦ã„ã‚‹ãŸã‚ã§ã™ï¼‰ï¼\næœ€çµ‚éœ€è¦ã«ã‚ˆã‚‹çµŒæ¸ˆæ³¢åŠåŠ¹æœã¯ï¼ŒåŸŸå†…ã®ç”Ÿç”£é¡ã ã‘ã§ãªãåŸŸå¤–ã‹ã‚‰ã®ç§»è¼¸å…¥ã‚’èª˜ç™ºã™ã‚‹ã¨è€ƒãˆã‚‰ã‚Œã¾ã™ï¼ã“ã®åŠ¹æœã‚’ç„¡è¦–ã™ã‚‹ã¨çµŒæ¸ˆæ³¢åŠåŠ¹æœã‚’éå¤§è©•ä¾¡ã™ã‚‹ã“ã¨ã«ã¤ãªãŒã‚‹ãŸã‚ï¼Œé€šå¸¸ï¼ŒæŠ•å…¥ä¿‚æ•°ã‹ã‚‰ç§»è¼¸å…¥ç›¸å½“åˆ†ã‚’å·®ã—å¼•ãã¨ã„ã†å‡¦ç†ãŒè¡Œã‚ã‚Œã¾ã™ï¼\nç§»è¼¸å…¥ã¯åŸŸå†…éœ€è¦ã«ãŠãŠã‚ˆãæ¯”ä¾‹ã™ã‚‹ã¨è€ƒãˆã‚‰ã‚Œã‚‹ãŸã‚ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ï¼Œç§»è¼¸å…¥ä¿‚æ•°\\(\\hat{M_i}\\)ãŒç®—å‡ºã§ãã¾ã™ï¼\n\\[\n\\hat{M_i} = \\frac{M_i}{\\sum_{j}a_{ij}X_j + F_i}\n\\]\nã•ã‚‰ã«ï¼Œè¡Œåˆ—ã§ã®è¨ˆç®—ã«é©ã—ãŸç§»è¼¸å…¥ä¿‚æ•°è¡Œåˆ—\\(\\hat{M}\\)ãŒï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¾ã™ï¼\n\\[\n\\hat{M} =\n\\begin{pmatrix}\n  \\hat{M_1} & & 0 \\\\\n  & \\ddots & \\\\\n  0 & & \\hat{M_n} \\\\\n\\end{pmatrix}\n\\]\nä»¥ä¸Šã‚ˆã‚Šï¼Œç”Ÿç”£é¡ã®ãƒãƒ©ãƒ³ã‚¹å¼ï¼ˆè¡Œæ–¹å‘ï¼‰ã¯ï¼Œç§»è¼¸å…¥ä¿‚æ•°è¡Œåˆ—\\(\\hat{M}\\)ã‚’ç”¨ã„ã¦ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰å½¢ã•ã‚Œã¾ã™ï¼ãŸã ã—ï¼Œ\\(I\\)ã¯å˜ä½è¡Œåˆ—ï¼ˆå¯¾è§’æˆåˆ†ãŒ1ï¼Œãã‚Œä»¥å¤–ãŒ0ã®æ­£æ–¹è¡Œåˆ—ï¼‰ã§ã™ï¼\n\\[\n\\begin{align}\n  AX + F + E - \\hat{M} (AX + F) &= X \\\\\n  (I - \\hat{M}) (AX + F) + E &= X\n\\end{align}\n\\]\nä¸Šã®ãƒãƒ©ãƒ³ã‚¹å¼ã‚ˆã‚Šï¼ŒçµŒæ¸ˆæ³¢åŠåŠ¹æœã®ç®—å‡ºå¼ãŒï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«å°å‡ºã•ã‚Œã¾ã™ï¼ã“ã“ã§ï¼Œ\\(\\Delta X\\)ï¼Œ\\(\\Delta F\\)ã¯ï¼Œãã‚Œãã‚Œï¼Œç”Ÿç”£é¡ã®å¤‰åŒ–é‡ï¼Œæœ€çµ‚éœ€è¦ã®å¤‰åŒ–é‡ã§ã™ï¼\n\\[\n\\begin{align}\n  X &= (I - \\hat{M}) (AX + F) + E \\\\\n  [I - (I - \\hat{M}) A] X &= (I - \\hat{M}) F + E \\\\\n  X &= [I - (I - \\hat{M}) A] ^ {-1} [(I - \\hat{M}) F + E] \\\\\n  \\Delta X &= [I - (I - \\hat{M}) A] ^ {-1} (I - \\hat{M}) \\Delta F\n\\end{align}\n\\]\nç”Ÿç”£é¡ã®å¤‰åŒ–é‡\\(\\Delta X\\)ã®å¼ã®å³è¾ºã®\\((I - \\hat{M}) \\Delta F\\)ã¯ï¼Œæœ€çµ‚éœ€è¦ã®å¤‰åŒ–é‡ã«è‡ªçµ¦ç‡\\(I - \\hat{M}\\)ã‚’æ›ã‘ãŸå€¤ã¨ãªã£ã¦ã„ã¾ã™ï¼\nã¾ãŸï¼Œ\\([I - (I - \\hat{M}) A] ^ {-1}\\)ã¯ï¼Œæœ€çµ‚éœ€è¦ã®å¤‰åŒ–ã«ã‚ˆã‚‹ç›´æ¥ãƒ»é–“æ¥ã®æ³¢åŠåŠ¹æœã‚’è¡¨ã™è¡Œåˆ—ã§ã‚ã‚Šï¼ˆé–‹æ”¾å‹ã¾ãŸã¯ç«¶äº‰ç§»è¼¸å…¥å‹ã®ï¼‰ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™ï¼\nä»¥ä¸Šã®ã‚ˆã†ã«ï¼Œæœ€çµ‚éœ€è¦ã®å¤‰åŒ–é‡\\(\\Delta F\\)ã‹ã‚‰ç”Ÿç”£é¡ã®å¤‰åŒ–é‡\\(\\Delta X\\)ã‚’æ¨è¨ˆã™ã‚‹ã¨ã„ã†ã®ãŒï¼Œæœ€ã‚‚ä¸€èˆ¬çš„ãªç”£æ¥­é€£é–¢åˆ†æã®æ–¹æ³•ã¨ãªã£ã¦ã„ã¾ã™ï¼"
  },
  {
    "objectID": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html#rã«ã‚ˆã‚‹ç”£æ¥­é€£é–¢åˆ†æ",
    "href": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html#rã«ã‚ˆã‚‹ç”£æ¥­é€£é–¢åˆ†æ",
    "title": "ğŸ—¾Rã§ç”£æ¥­é€£é–¢åˆ†æ",
    "section": "Rã«ã‚ˆã‚‹ç”£æ¥­é€£é–¢åˆ†æ",
    "text": "Rã«ã‚ˆã‚‹ç”£æ¥­é€£é–¢åˆ†æ\n\nç”£æ¥­é€£é–¢è¡¨ã®æ•´å½¢\nã“ã“ã§ã¯ï¼Œ ã“ã¡ã‚‰ ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹æ—¥æœ¬ã®2011å¹´ã®3éƒ¨é–€è¡¨ï¼ˆiotable_3sector_2011_wider.csvï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ï¼\nã“ã¡ã‚‰ã®è¡¨ã¯ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ï¼Œæ—¥æœ¬ã®2011å¹´ã®13éƒ¨é–€è¡¨ã‚ˆã‚Šä½œæˆã—ãŸã‚‚ã®ã§ï¼Œå˜ä½ã¯ã€Œç™¾ä¸‡å††ã€ã§ã™ï¼\n\n13éƒ¨é–€ã®ç”£æ¥­åˆ†é¡ã‚’ç¬¬1æ¬¡ãƒ»ç¬¬2æ¬¡ãƒ»ç¬¬3æ¬¡ç”£æ¥­ã«é›†è¨ˆï¼ˆæ³¨ï¼šã€Œåˆ†é¡ä¸æ˜ã€ã‚’ç¬¬3æ¬¡ç”£æ¥­ã«åˆ†é¡ï¼‰\nä»˜åŠ ä¾¡å€¤éƒ¨é–€ã‚’1éƒ¨é–€ã«é›†è¨ˆ\næœ€çµ‚éœ€è¦éƒ¨é–€ã‚’åŸŸå†…æœ€çµ‚éœ€è¦ï¼ˆfinaldemandï¼‰ãƒ»è¼¸å‡ºï¼ˆexportï¼‰ãƒ»è¼¸å…¥ï¼ˆimportï¼‰ã®3éƒ¨é–€ã«é›†è¨ˆ\n\nç”£æ¥­é€£é–¢è¡¨ã®ãƒ‡ãƒ¼ã‚¿å½¢å¼ã¯ï¼Œe-Statã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§æä¾›ã•ã‚Œã¦ã„ã‚‹è¡¨ãªã©ã‚’é™¤ã„ã¦ï¼Œ è¡Œã«æŠ•å…¥éƒ¨é–€ï¼ˆinputï¼‰ãƒ»åˆ—ã«ç”£å‡ºéƒ¨é–€ï¼ˆoutputï¼‰ã‚’æŒã¤ã€Œæ¨ªé•·ãƒ‡ãƒ¼ã‚¿ã€ã§ã‚ã‚‹ã“ã¨ãŒå¤šã„ã¨æ€ã‚ã‚Œã¾ã™ï¼\nã“ã“ã§ã‚‚ï¼Œä»¥ä¸‹ã®é€šã‚Šï¼Œã¾ãšã¯æ¨ªé•·ã®ç”£æ¥­é€£é–¢è¡¨ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã™ï¼\n\nlibrary(tidyverse)\n\niotable_wider <- read_csv(\"iotable_3sector_2011_wider.csv\",\n                          col_types = cols(.default = \"c\")) |> \n  \n  # input (æŠ•å…¥) åˆ—ä»¥å¤–ã‚’æ•°å€¤ã«å¤‰æ›\n  mutate(across(!input, parse_number))\n\nknitr::kable(iotable_wider)\n\n\n\n\n\n\n\n\n\n\n\n\n\ninput\nindustry/01_primary\nindustry/02_secondary\nindustry/03_tertiary\nfinaldemand/04_finaldemand\nexport/05_export\nimport/06_import\n\n\n\n\nindustry/01_primary\n1456611\n7850628\n1373767\n3869875\n47890\n-2562809\n\n\nindustry/02_secondary\n2715710\n161897553\n62841827\n132924323\n54473273\n-71673715\n\n\nindustry/03_tertiary\n2025270\n66811645\n155796589\n352324555\n16423417\n-8921553\n\n\nvalueadded/04_valueadded\n5838371\n106619145\n364447740\nNA\nNA\nNA\n\n\n\n\n\nãƒ‡ãƒ¼ã‚¿åˆ†æã«ãŠã„ã¦ã¯ï¼Œã€Œæ¨ªé•·ãƒ‡ãƒ¼ã‚¿ã€ã‚ˆã‚Šã‚‚ï¼Œä»¥ä¸‹ã®ã‚ˆã†ãªã€Œç¸¦é•·ãƒ‡ãƒ¼ã‚¿ã€ã®ã»ã†ãŒï¼Œ åˆ†æã—ã‚„ã™ã„å ´åˆãŒå¤šãã‚ã‚Šã¾ã™ï¼ ã“ã“ã§ã‚‚ï¼Œæ¨ªé•·ã®ç”£æ¥­é€£é–¢è¡¨ã‚’ã€Œç¸¦é•·ãƒ‡ãƒ¼ã‚¿ã€ã«å¤‰æ›ã—ã¾ã™ï¼\n\niotable <- iotable_wider |>\n  \n  # input (æŠ•å…¥) åˆ—ã‚’åˆ†é¡ãƒ»åç§°ã«åˆ†å‰²\n  separate(input, c(\"input_type\", \"input_name\"),\n           sep = \"/\") |>\n  \n  # input (æŠ•å…¥) ã¨åŒæ§˜ã«output (ç”£å‡º) ã®åˆ†é¡ãƒ»åç§°åˆ—ã‚’è¿½åŠ ã—ç¸¦é•·ãƒ‡ãƒ¼ã‚¿ã«\n  pivot_longer(!c(input_type, input_name),\n               names_to = c(\"output_type\", \"output_name\"),\n               names_sep = \"/\",\n               values_to = \"value_M\") |>\n  \n  # æ•°å€¤ãŒå­˜åœ¨ã—ãªã„è¡Œã‚’å‰Šé™¤\n  drop_na(value_M)\n\nknitr::kable(iotable)\n\n\n\n\ninput_type\ninput_name\noutput_type\noutput_name\nvalue_M\n\n\n\n\nindustry\n01_primary\nindustry\n01_primary\n1456611\n\n\nindustry\n01_primary\nindustry\n02_secondary\n7850628\n\n\nindustry\n01_primary\nindustry\n03_tertiary\n1373767\n\n\nindustry\n01_primary\nfinaldemand\n04_finaldemand\n3869875\n\n\nindustry\n01_primary\nexport\n05_export\n47890\n\n\nindustry\n01_primary\nimport\n06_import\n-2562809\n\n\nindustry\n02_secondary\nindustry\n01_primary\n2715710\n\n\nindustry\n02_secondary\nindustry\n02_secondary\n161897553\n\n\nindustry\n02_secondary\nindustry\n03_tertiary\n62841827\n\n\nindustry\n02_secondary\nfinaldemand\n04_finaldemand\n132924323\n\n\nindustry\n02_secondary\nexport\n05_export\n54473273\n\n\nindustry\n02_secondary\nimport\n06_import\n-71673715\n\n\nindustry\n03_tertiary\nindustry\n01_primary\n2025270\n\n\nindustry\n03_tertiary\nindustry\n02_secondary\n66811645\n\n\nindustry\n03_tertiary\nindustry\n03_tertiary\n155796589\n\n\nindustry\n03_tertiary\nfinaldemand\n04_finaldemand\n352324555\n\n\nindustry\n03_tertiary\nexport\n05_export\n16423417\n\n\nindustry\n03_tertiary\nimport\n06_import\n-8921553\n\n\nvalueadded\n04_valueadded\nindustry\n01_primary\n5838371\n\n\nvalueadded\n04_valueadded\nindustry\n02_secondary\n106619145\n\n\nvalueadded\n04_valueadded\nindustry\n03_tertiary\n364447740\n\n\n\n\n\nä¸Šã§æ§‹ç¯‰ã—ãŸè¡¨ãƒ‡ãƒ¼ã‚¿ã¯ï¼Œå„è¡Œã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãªã©ãŒå®¹æ˜“ã«ã§ãã‚‹ä¸€æ–¹ã§ï¼Œ ç”£æ¥­é€£é–¢åˆ†æã«ç”¨ã„ã‚‰ã‚Œã‚‹è¡Œåˆ—è¨ˆç®—ãªã©ã«é©ã—ã¦ã„ã¾ã›ã‚“ï¼\nãã“ã§ï¼Œè¡¨ãƒ‡ãƒ¼ã‚¿ã®åŸºæœ¬çš„ãªæ¼”ç®—ã¨è¡Œåˆ—è¨ˆç®—ã‚’åŒæ™‚ã«è¡Œãˆã‚‹dibbleãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ã¾ã™ï¼ ä»¥ä¸‹ã®ã‚ˆã†ã«ï¼Œç”£æ¥­é€£é–¢è¡¨ã‚’dibbleã«å¤‰æ›ã—ã¾ã™ï¼\n\n# pak::pak(\"UchidaMizuki/dibble\")\nlibrary(dibble)\n\niotable <- iotable |>\n  dibble_by(input = c(input_type, input_name),\n            output = c(output_type, output_name),\n            \n            # \"_\"ã§åˆ—åã‚’åˆ†å‰²ã—ã¦input (æŠ•å…¥)ãƒ»output (ç”£å‡º) è»¸ã‚’è¨­å®š\n            .names_sep = \"_\")\n\niotable\n\n# A dibble:   24 x 1\n# Dimensions: input [4], output [6]\n# Measures:   value_M\n   input$type $name        output$type $name            value_M\n   <chr>      <chr>        <chr>       <chr>              <dbl>\n 1 industry   01_primary   industry    01_primary       1456611\n 2 industry   01_primary   industry    02_secondary     7850628\n 3 industry   01_primary   industry    03_tertiary      1373767\n 4 industry   01_primary   finaldemand 04_finaldemand   3869875\n 5 industry   01_primary   export      05_export          47890\n 6 industry   01_primary   import      06_import       -2562809\n 7 industry   02_secondary industry    01_primary       2715710\n 8 industry   02_secondary industry    02_secondary   161897553\n 9 industry   02_secondary industry    03_tertiary     62841827\n10 industry   02_secondary finaldemand 04_finaldemand 132924323\n# â€¦ with 14 more rows\n\n\n\n\næŠ•å…¥ä¿‚æ•°è¡Œåˆ—ã®ç®—å‡º\nç”£æ¥­ã®ã€Œã‚¯ãƒƒã‚­ãƒ³ã‚°ãƒ¬ã‚·ãƒ”ã€ã¨å‘¼ã°ã‚Œã‚‹æŠ•å…¥ä¿‚æ•°è¡Œåˆ—\\(A\\)ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ä¸­é–“æŠ•å…¥ã‚’ç”Ÿç”£é¡ã§å‰²ã£ã¦ç®—å‡ºã—ã¾ã™ï¼\næ³¨ï¼šdibbleã§ã¯ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆãŒè‡ªå‹•ã§è¡Œã‚ã‚Œã¾ã™ãŒï¼Œå®‰å…¨ã®ãŸã‚ï¼Œãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆã‚’è¡Œã†éš›ã«ï¼Œè­¦å‘Šã‚’ç™ºã™ã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ï¼ãã®ãŸã‚ï¼Œbroadcast()ã§ãƒ–ãƒ­ãƒ¼ãƒ‰ã‚­ãƒ£ã‚¹ãƒˆå¾Œã®è»¸åc(\"input\", \"output\")ã‚’ä¸ãˆã¦è­¦å‘ŠãŒå‡ºãªã„ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼\n\n# ç”Ÿç”£é¡\ntotal_input <- iotable |>\n  filter(output$type == \"industry\") |>\n  apply(\"output\", sum)\n\n# ä¸­é–“æŠ•å…¥\ninterindustry <- iotable |>\n  filter(input$type == \"industry\",\n         output$type == \"industry\")\n\n# æŠ•å…¥ä¿‚æ•°\ninputcoeff <- broadcast(interindustry / total_input,\n                        c(\"input\", \"output\"))\n\ninputcoeff\n\n# A dibble:   9\n# Dimensions: input [3], output [3]\n  input$type $name        output$type $name              .\n  <chr>      <chr>        <chr>       <chr>          <dbl>\n1 industry   01_primary   industry    01_primary   0.121  \n2 industry   01_primary   industry    02_secondary 0.0229 \n3 industry   01_primary   industry    03_tertiary  0.00235\n4 industry   02_secondary industry    01_primary   0.226  \n5 industry   02_secondary industry    02_secondary 0.472  \n6 industry   02_secondary industry    03_tertiary  0.108  \n7 industry   03_tertiary  industry    01_primary   0.168  \n8 industry   03_tertiary  industry    02_secondary 0.195  \n9 industry   03_tertiary  industry    03_tertiary  0.267  \n\n\n\n\nãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ã®ç®—å‡º\nçµŒæ¸ˆæ³¢åŠåŠ¹æœã‚’è¡¨ã™ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ï¼Œç§»è¼¸å…¥ä¿‚æ•°ã¨æŠ•å…¥ä¿‚æ•°ã‚’ç”¨ã„ã¦ç®—å‡ºã§ãã¾ã™ï¼\næ³¨ï¼šsolve()ã§é€†è¡Œåˆ—ã‚’ç®—å‡ºã™ã‚‹ã¨è¡Œåˆ—ã®è»¸åãŒå…¥ã‚Œæ›¿ã‚ã‚‹ãŸã‚æ³¨æ„ã—ã¦ãã ã•ã„ï¼\n\n# åŸŸå†…éœ€è¦\nlocaldemand <- iotable |>\n  filter(input$type == \"industry\",\n         !output$type %in% c(\"export\", \"import\")) |>\n  apply(\"input\", sum)\n\n# (ç§») è¼¸å…¥\nimport <- iotable |>\n  filter(input$type == \"industry\",\n         output$type == \"import\") |>\n  apply(\"input\", sum)\n# ç¬¦å·ã‚’æ­£ã«\nimport <- -import\n\n# (ç§») è¼¸å…¥ä¿‚æ•°\nimportcoeff <- import / localdemand\n\nI <- eye(inputcoeff) # å˜ä½è¡Œåˆ—\nM <- importcoeff     # ç§»è¼¸å…¥ä¿‚æ•°ãƒ™ã‚¯ãƒˆãƒ« (broadcastãŒè¡Œã‚ã‚Œã‚‹ãŸã‚è¡Œåˆ—ã§ãªãã¦ã‚ˆã„)\nA <- inputcoeff      # æŠ•å…¥ä¿‚æ•°è¡Œåˆ—\n\n# ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—\nleontiefinv <- broadcast(I - (1 - M) * A,\n                         c(\"input\", \"output\")) |>\n  solve()\n\nleontiefinv\n\n# A dibble:   9\n# Dimensions: output [3], input [3]\n  output$type $name        input$type $name              .\n  <chr>       <chr>        <chr>      <chr>          <dbl>\n1 industry    01_primary   industry   01_primary   1.12   \n2 industry    01_primary   industry   02_secondary 0.0361 \n3 industry    01_primary   industry   03_tertiary  0.00716\n4 industry    02_secondary industry   01_primary   0.374  \n5 industry    02_secondary industry   02_secondary 1.68   \n6 industry    02_secondary industry   03_tertiary  0.197  \n7 industry    03_tertiary  industry   01_primary   0.348  \n8 industry    03_tertiary  industry   02_secondary 0.445  \n9 industry    03_tertiary  industry   03_tertiary  1.41   \n\n\n\n\nçµŒæ¸ˆæ³¢åŠåŠ¹æœã®ç®—å‡º\nã“ã¡ã‚‰ ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹æœ€çµ‚éœ€è¦ãŒãã‚Œãã‚Œç™¾ä¸‡å††ãšã¤å¢—åŠ ã™ã‚‹ï¼ˆfinaldemand_change_3sector.csvï¼‰ã‚±ãƒ¼ã‚¹ã§çµŒæ¸ˆæ³¢åŠåŠ¹æœã‚’ç®—å‡ºã—ã¦ã„ã¾ã™ï¼\n\n# æœ€çµ‚éœ€è¦å¤‰åŒ–é‡\nfinaldemand_change <- read_csv(\"finaldemand_change_3sector.csv\",\n                               col_types = cols(.default = \"c\",\n                                                value_M = \"n\")) |> \n  dibble_by(input = c(input_type, input_name),\n            .names_sep = \"_\")\n\nL <- leontiefinv         # ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—\nM <- importcoeff         # ç§»è¼¸å…¥ä¿‚æ•°\nFD <- finaldemand_change # æœ€çµ‚éœ€è¦å¤‰åŒ–é‡\n\n# çµŒæ¸ˆæ³¢åŠåŠ¹æœ\nspillover <- L %*% ((1 - M) * FD)\n\nspillover\n\n# A dibble:   3\n# Dimensions: output [3]\n  output$type $name            .\n  <chr>       <chr>        <dbl>\n1 industry    01_primary   0.958\n2 industry    02_secondary 1.85 \n3 industry    03_tertiary  2.03 \n\n\n\nspillover |> \n  as_tibble(n = \"value_M\") |> \n  unpack(output, \"_\") |> \n  ggplot(aes(output_name, value_M,\n             fill = output_name)) +\n  geom_col(show.legend = FALSE) +\n  scale_fill_brewer(palette = \"Set2\")"
  },
  {
    "objectID": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html#ã¾ã¨ã‚",
    "href": "posts/ioanalysis-in-r-ja/ioanalysis-in-r-ja.html#ã¾ã¨ã‚",
    "title": "ğŸ—¾Rã§ç”£æ¥­é€£é–¢åˆ†æ",
    "section": "ã¾ã¨ã‚",
    "text": "ã¾ã¨ã‚\nRã‚’ç”¨ã„ãŸç”£æ¥­é€£é–¢åˆ†æã®æ–¹æ³•ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã—ãŸï¼\nã“ã“ã¾ã§ã®è¨ˆç®—ã‚’ï¼Œjpioã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å½¢å¼ã§ã¾ã¨ã‚ã¾ã—ãŸï¼ä»¥ä¸‹ã®ã‚ˆã†ã«ï¼Œã“ã“ã¾ã§ã®è¨ˆç®—ã¨åŒæ§˜ã®è¨ˆç®—ã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ï¼\n\n# pak::pak(\"UchidaMizuki/jpio\")\n\n# ç”£æ¥­é€£é–¢è¡¨\niotable <- read_csv(\"iotable_3sector_2011.csv\",\n                    col_types = cols(.default = \"c\",\n                                     value_M = \"n\")) |> \n  jpio::as_iotable()\n\niotable\n\n# A dibble:   24\n# Dimensions: input [4], output [6]\n   input$type $name        output$type $name                  .\n   <fct>      <chr>        <fct>       <chr>              <dbl>\n 1 industry   01_primary   industry    01_primary       1456611\n 2 industry   01_primary   industry    02_secondary     7850628\n 3 industry   01_primary   industry    03_tertiary      1373767\n 4 industry   01_primary   finaldemand 04_finaldemand   3869875\n 5 industry   01_primary   export      05_export          47890\n 6 industry   01_primary   import      06_import       -2562809\n 7 industry   02_secondary industry    01_primary       2715710\n 8 industry   02_secondary industry    02_secondary   161897553\n 9 industry   02_secondary industry    03_tertiary     62841827\n10 industry   02_secondary finaldemand 04_finaldemand 132924323\n# â€¦ with 14 more rows\n\n# æŠ•å…¥ä¿‚æ•°\njpio::input_coeff(iotable)\n\n# A dibble:   9\n# Dimensions: input [3], output [3]\n  input$type $name        output$type $name              .\n  <fct>      <chr>        <fct>       <chr>          <dbl>\n1 industry   01_primary   industry    01_primary   0.121  \n2 industry   01_primary   industry    02_secondary 0.0229 \n3 industry   01_primary   industry    03_tertiary  0.00235\n4 industry   02_secondary industry    01_primary   0.226  \n5 industry   02_secondary industry    02_secondary 0.472  \n6 industry   02_secondary industry    03_tertiary  0.108  \n7 industry   03_tertiary  industry    01_primary   0.168  \n8 industry   03_tertiary  industry    02_secondary 0.195  \n9 industry   03_tertiary  industry    03_tertiary  0.267  \n\n# ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—\njpio::leontief_inv(iotable)\n\n# A dibble:   9\n# Dimensions: output [3], input [3]\n  output$type $name        input$type $name              .\n  <fct>       <chr>        <fct>      <chr>          <dbl>\n1 industry    01_primary   industry   01_primary   1.12   \n2 industry    01_primary   industry   02_secondary 0.0361 \n3 industry    01_primary   industry   03_tertiary  0.00716\n4 industry    02_secondary industry   01_primary   0.374  \n5 industry    02_secondary industry   02_secondary 1.68   \n6 industry    02_secondary industry   03_tertiary  0.197  \n7 industry    03_tertiary  industry   01_primary   0.348  \n8 industry    03_tertiary  industry   02_secondary 0.445  \n9 industry    03_tertiary  industry   03_tertiary  1.41   \n\n# çµŒæ¸ˆæ³¢åŠåŠ¹æœ\njpio::spillover_effect(iotable,\n                       list(`01_primary` = 1,\n                            `02_secondary` = 1,\n                            `03_tertiary` = 1))\n\n# A dibble:   3\n# Dimensions: output [3]\n  output$type $name            .\n  <fct>       <chr>        <dbl>\n1 industry    01_primary   0.958\n2 industry    02_secondary 1.85 \n3 industry    03_tertiary  2.03"
  },
  {
    "objectID": "posts/use-parquet-instead-of-csv-ja/use-parquet-instead-of-csv-ja.html",
    "href": "posts/use-parquet-instead-of-csv-ja/use-parquet-instead-of-csv-ja.html",
    "title": "ğŸ—¾CSVã®ä»£ã‚ã‚Šã«Parquetã‚’ä½¿ã£ã¦ã¿ã‚ˆã†",
    "section": "",
    "text": "æœ¬è¨˜äº‹ã§ã¯ï¼ŒCSVã®ä»£æ›¿ã¨ã—ã¦æœ‰æœ›ã‹ã¤ãƒ“ãƒƒã‚°ãƒ‡ãƒ¼ã‚¿åˆ†æã«ã‚‚é©ã—ã¦ã„ã‚‹Parquetã‚’ç´¹ä»‹ã—ã¾ã™ï¼\nã•ã¦ï¼Œãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ï¼ˆData Framesï¼‰ã¯ï¼Œãƒ‡ãƒ¼ã‚¿åˆ†æã«ãŠã„ã¦æœ€ã‚‚åŸºæœ¬çš„ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®1ã¤ã§ã™ï¼Rã®tibbleãƒ»dplyrã‚„Pythonã®pandasãªã©ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ æ“ä½œã®ãŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ãˆã°ï¼Œã“ã‚Œã¾ã§Excelãªã©ã®è¡¨è¨ˆç®—ã‚½ãƒ•ãƒˆã§è¡Œã£ã¦ã„ãŸãƒ‡ãƒ¼ã‚¿åˆ†æã‚’ã•ã‚‰ã«åŠ¹ç‡çš„ã«è¡Œã†ã“ã¨ãŒã§ãã¾ã™ï¼\nã“ã®ã‚ˆã†ã«ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ„ãƒ¼ãƒ«ãŒå……å®Ÿã—ã¦ã„ã‚‹ä¸€æ–¹ã§ï¼Œãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«ã¯Excelãªã©ã¨ã®äº’æ›æ€§ãŒé«˜ã„CSVãŒæœªã ã«åºƒãä½¿ã‚ã‚Œã¦ã„ã¾ã™ï¼ã—ã‹ã—ï¼ŒCSVã¯ï¼Œå¿…ãšã—ã‚‚ãƒ‡ãƒ¼ã‚¿åˆ†æã«é©ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã¨ã¯è¨€ãˆã¾ã›ã‚“ï¼ãã“ã§ï¼ŒCSVã®ä»£æ›¿ã¨ã—ã¦ä½¿ã‚ã‚Œã‚‹ã“ã¨ãŒå¤šããªã£ã¦ã„ã‚‹Parquetã‚’CSVã¨æ¯”è¼ƒã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼"
  },
  {
    "objectID": "posts/use-parquet-instead-of-csv-ja/use-parquet-instead-of-csv-ja.html#ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™",
    "href": "posts/use-parquet-instead-of-csv-ja/use-parquet-instead-of-csv-ja.html#ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™",
    "title": "ğŸ—¾CSVã®ä»£ã‚ã‚Šã«Parquetã‚’ä½¿ã£ã¦ã¿ã‚ˆã†",
    "section": "ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™",
    "text": "ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™\nCSVã¨Parquetã‚’æ¯”è¼ƒã™ã‚‹ãŸã‚ï¼Œã¾ãšã¯ï¼Œãƒ‡ãƒ¼ã‚¿åˆ†æã«ã‚ã‚ŠãŒã¡ãªã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ç”¨æ„ã—ã¾ã—ã‚‡ã†ï¼ä»Šå›ã¯ï¼Œtidyrãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§æä¾›ã•ã‚Œã¦ã„ã‚‹who ï¼ˆä¸–ç•Œä¿å¥æ©Ÿé–¢ï¼ˆWHOï¼‰çµæ ¸ãƒ‡ãƒ¼ã‚¿ï¼‰ã‹ã‚‰ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ã¤ãã‚Šã¾ã™ï¼\nè¿‘å¹´ï¼Œãƒ‡ãƒ¼ã‚¿åˆ†æã§ã¯ï¼Œæ•´ç„¶ãƒ‡ãƒ¼ã‚¿ï¼ˆtidy dataï¼‰ã®æ¦‚å¿µãŒæ™®åŠã—ã¦ã„ã¾ã™ï¼tidy dataã¯ï¼Œå€‹ã€…ã®å¤‰æ•°ãŒ1ã¤ã®åˆ—ã‚’ãªã—ï¼Œå€‹ã€…ã®è¦³æ¸¬ï¼ˆå€¤ï¼‰ãŒ1ã¤ã®è¡Œã‚’ãªã™ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã§ã™ï¼\nãã‚Œã§ã¯ï¼Œwhoã¯ï¼Œtidy dataã¨è¨€ãˆã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿwhoã«ã¯ï¼Œ\"new_sp_m014\" ï½\"newrel_f65\" ã¨ã„ã£ãŸãŸãã•ã‚“ã®åˆ—ãŒå­˜åœ¨ã—ã¾ã™ãŒï¼Œã“ã‚Œã‚‰ã«ã¯ï¼Œ1åˆ—ã”ã¨ã«ï¼Œè¨ºæ–­çµæœï¼ˆspã‚„selï¼‰ãƒ»æ€§åˆ¥ï¼ˆmã¨fï¼‰ãƒ»å¹´é½¢éšç´šï¼ˆ014ã‚„65ï¼‰ã¨ã„ã£ãŸè¤‡æ•°ã®å¤‰æ•°ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ï¼ãã®ãŸã‚ï¼Œwho ã¯ï¼Œtidy dataã§ãªã„ã¨ã„ãˆã¾ã™ï¼ãã“ã§ï¼Œã“ã¡ã‚‰ã«å¾“ã£ã¦tidy dataã§ã‚ã‚‹who_longerã«å¤‰å½¢ã—ã¾ã™ï¼\nãƒ‡ãƒ¼ã‚¿åˆ†æã§ã¯ï¼Œwho ã‚ˆã‚Štidy dataã§ã‚ã‚‹who_longer ã®ã»ã†ã‚’åˆ†æãŒè¡Œã„ã‚„ã™ã„ä¸€æ–¹ã§ï¼Œè¡Œæ•°ã¯whoï¼ˆç´„7,000è¡Œï¼‰ã‚ˆã‚Šwho_longer ï¼ˆç´„400,000è¡Œï¼‰ã®ã»ã†ãŒç´„50å€å¤šã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼ãã®ãŸã‚ï¼Œtidy dataã§ã‚ã‚‹who_longerã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ã‚’ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§ã‚ã‚‹CSVã§ä¿å­˜ã™ã‚‹ã¨å®¹é‡ãŒå¢—å¤§ã—ã¦ã—ã¾ã„ã¾ã™ï¼\nã“ã®ã‚ˆã†ã«ï¼Œtidy dataã¯ãƒ‡ãƒ¼ã‚¿åˆ†æã«é©ã—ã¦ã„ã‚‹ä¸€æ–¹ã§ï¼ŒCSVã®ã‚ˆã†ãªãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã§ã®ä¿å­˜ã«é©ã—ã¦ã„ãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼ã—ã‹ã—ï¼Œã“ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ä¿å­˜ä¸Šã®èª²é¡Œã¯Parquetã‚’ä½¿ãˆã°è§£æ±ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼\nã“ã“ã§ï¼Œtidy dataã§ãªã„who ã¨tidy dataã§ã‚ã‚‹who_longer ã‚’è¦‹æ¯”ã¹ã¦ã¿ã¾ã—ã‚‡ã†ï¼\n\nlibrary(tidyverse)\nlibrary(fs)\n\n\n\nã‚³ãƒ¼ãƒ‰\nlevels_gender <- c(\"f\", \"m\")\nlevels_age <- c(\"014\", \"1524\", \"2534\", \"3544\", \"4554\", \"5564\", \"65\")\n\nwho_longer <- who |> \n  pivot_longer(cols = new_sp_m014:newrel_f65,\n               names_to = c(\"diagnosis\", \"gender\", \"age\"), \n               names_pattern = \"new_?(.*)_(.)(.*)\",\n               names_transform = list(gender = ~ .x |> \n                                        readr::parse_factor(levels = levels_gender),\n                                      age = ~ .x |> \n                                        readr::parse_factor(levels = levels_age,\n                                                            ordered = TRUE)),\n               values_to = \"count\")\n\n\n\n# ãƒ‡ãƒ¼ã‚¿æ•´å½¢å‰\nprint(who, n = 5)\n\n# A tibble: 7,240 Ã— 60\n  country   iso2  iso3   year new_sp_m014 new_sp_m1524 new_sp_m2534 new_sp_m3544\n  <chr>     <chr> <chr> <int>       <int>        <int>        <int>        <int>\n1 Afghanisâ€¦ AF    AFG    1980          NA           NA           NA           NA\n2 Afghanisâ€¦ AF    AFG    1981          NA           NA           NA           NA\n3 Afghanisâ€¦ AF    AFG    1982          NA           NA           NA           NA\n4 Afghanisâ€¦ AF    AFG    1983          NA           NA           NA           NA\n5 Afghanisâ€¦ AF    AFG    1984          NA           NA           NA           NA\n# â€¦ with 7,235 more rows, and 52 more variables: new_sp_m4554 <int>,\n#   new_sp_m5564 <int>, new_sp_m65 <int>, new_sp_f014 <int>,\n#   new_sp_f1524 <int>, new_sp_f2534 <int>, new_sp_f3544 <int>,\n#   new_sp_f4554 <int>, new_sp_f5564 <int>, new_sp_f65 <int>,\n#   new_sn_m014 <int>, new_sn_m1524 <int>, new_sn_m2534 <int>,\n#   new_sn_m3544 <int>, new_sn_m4554 <int>, new_sn_m5564 <int>,\n#   new_sn_m65 <int>, new_sn_f014 <int>, new_sn_f1524 <int>, â€¦\n\n# ãƒ‡ãƒ¼ã‚¿æ•´å½¢å¾Œ\nprint(who_longer, n = 5)\n\n# A tibble: 405,440 Ã— 8\n  country     iso2  iso3   year diagnosis gender age   count\n  <chr>       <chr> <chr> <int> <chr>     <fct>  <ord> <int>\n1 Afghanistan AF    AFG    1980 sp        m      014      NA\n2 Afghanistan AF    AFG    1980 sp        m      1524     NA\n3 Afghanistan AF    AFG    1980 sp        m      2534     NA\n4 Afghanistan AF    AFG    1980 sp        m      3544     NA\n5 Afghanistan AF    AFG    1980 sp        m      4554     NA\n# â€¦ with 405,435 more rows"
  },
  {
    "objectID": "posts/use-parquet-instead-of-csv-ja/use-parquet-instead-of-csv-ja.html#csvparquetã®ä¿å­˜æ–¹æ³•",
    "href": "posts/use-parquet-instead-of-csv-ja/use-parquet-instead-of-csv-ja.html#csvparquetã®ä¿å­˜æ–¹æ³•",
    "title": "ğŸ—¾CSVã®ä»£ã‚ã‚Šã«Parquetã‚’ä½¿ã£ã¦ã¿ã‚ˆã†",
    "section": "CSVãƒ»Parquetã®ä¿å­˜æ–¹æ³•",
    "text": "CSVãƒ»Parquetã®ä¿å­˜æ–¹æ³•\nRã§ã¯ï¼Œwrite_csv() ã§CSVã‚’ä¿å­˜ã§ãã¾ã™ï¼åŒæ§˜ã«ï¼Œarrowãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®write_parquet() ã§Parquetã‚’ä¿å­˜ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼who_longerã‚’CSVã¨Parquetã§ä¿å­˜ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\nCSVã¨Parquetã§ã¯ï¼Œã©ã¡ã‚‰ã‚‚ç°¡å˜ã«ãƒ‡ãƒ¼ã‚¿ä¿å­˜ãŒã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼\n\nlibrary(arrow)\n\n# CSVã‚’ä¿å­˜\nwrite_csv(who_longer, \"who_longer.csv\")\n\n# Parquetã‚’ä¿å­˜\nwrite_parquet(who_longer, \"who_longer.parquet\")"
  },
  {
    "objectID": "posts/use-parquet-instead-of-csv-ja/use-parquet-instead-of-csv-ja.html#parquetã®ãƒ¡ãƒªãƒƒãƒˆcsvã¨ã®æ¯”è¼ƒ",
    "href": "posts/use-parquet-instead-of-csv-ja/use-parquet-instead-of-csv-ja.html#parquetã®ãƒ¡ãƒªãƒƒãƒˆcsvã¨ã®æ¯”è¼ƒ",
    "title": "ğŸ—¾CSVã®ä»£ã‚ã‚Šã«Parquetã‚’ä½¿ã£ã¦ã¿ã‚ˆã†",
    "section": "Parquetã®ãƒ¡ãƒªãƒƒãƒˆãƒ»CSVã¨ã®æ¯”è¼ƒ",
    "text": "Parquetã®ãƒ¡ãƒªãƒƒãƒˆãƒ»CSVã¨ã®æ¯”è¼ƒ\nã“ã“ã‹ã‚‰ã¯ï¼Œä¿å­˜ã—ãŸwho_longer ã®CSVãƒ»Parquetãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¯”è¼ƒã—ã¦ï¼ŒCSVã«å¯¾ã™ã‚‹Parquetã®ãƒ¡ãƒªãƒƒãƒˆã‚’ç´¹ä»‹ã—ã¦ã„ãã¾ã™ï¼\n\nãƒ¡ãƒªãƒƒãƒˆ1ï¼šCSVã‚ˆã‚Šãƒ‡ãƒ¼ã‚¿å®¹é‡ãŒè»½ã„\ntidy dataã¯è¡Œæ•°ãŒå¤šããªã‚‹ãŸã‚ï¼ŒCSVã§ã®ä¿å­˜ã«é©ã—ã¦ãŠã‚‰ãšï¼ŒParquetã‚’ä½¿ã£ãŸã»ã†ãŒã‚ˆã„ã“ã¨ã‚’æ—¢ã«è¿°ã¹ã¾ã—ãŸï¼\nå®Ÿéš›ã«ï¼Œwho_longer ã®CSVãƒ»Parquetã®ãƒ‡ãƒ¼ã‚¿å®¹é‡ã¯ï¼Œãã‚Œãã‚Œï¼Œ14.1 MBã¨154 KBã¨ãªã‚Šï¼ŒParquetã¯CSVã®ç´„1 %ã®ãƒ‡ãƒ¼ã‚¿å®¹é‡ã—ã‹ãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ï¼\nã©ã®ã‚ˆã†ãªã‚±ãƒ¼ã‚¹ã§ã‚‚ã“ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿å®¹é‡ã®å‰Šæ¸›ãŒè¦‹è¾¼ã‚ã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒï¼ŒParquetã¯åˆ—æŒ‡å‘ã§ãƒ‡ãƒ¼ã‚¿åœ§ç¸®ã‚’è¡Œã†ãŸã‚ï¼ŒRãªã©ã§ã‚ˆãç”¨ã„ã‚‰ã‚Œã‚‹tidy dataã®ä¿å­˜ã«é©ã—ãŸãƒ‡ãƒ¼ã‚¿å½¢å¼ã§ã‚ã‚‹ã¨ã„ãˆã¾ã™ï¼\n\n# CSV\nfile_size(\"who_longer.csv\")\n\n14.1M\n\n# Parquet\nfile_size(\"who_longer.parquet\")\n\n154K\n\nunits::set_units(file_size(\"who_longer.parquet\") / file_size(\"who_longer.csv\")) |> \n  units::set_units(`%`)\n\n1.070468 [%]\n\n\n\n\nãƒ¡ãƒªãƒƒãƒˆ2ï¼šCSVã‚ˆã‚Šèª­ã¿è¾¼ã¿ãŒç°¡å˜\nwrite_csv()ãƒ»write_parquet() ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãè¾¼ã‚ã‚‹ã®ã¨åŒæ§˜ã«ï¼Œread_csv()ãƒ»read_parquet() ã§CSVãƒ»Parquetãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã“ã¨ãŒã§ãã¾ã™ï¼\nCSVã¯ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã§ã‚ã‚‹ãŸã‚ï¼Œèª­ã¿è¾¼ã¿æ™‚ã«col_typesã§å„åˆ—ã®å‹ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯è‡ªå‹•ã§å‹ã‚’æ¨æ¸¬ï¼‰ï¼\nä¸€æ–¹ï¼ŒParquetã¯ï¼Œæ›¸ãè¾¼ã¿æ™‚ã«å„åˆ—ã®å‹æƒ…å ±ã‚‚ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ãŸã‚èª­ã¿è¾¼ã¿æ™‚ã«å‹ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“ï¼\n\n# CSVã®èª­ã¿è¾¼ã¿\nread_csv(\"who_longer.csv\",\n         col_types = cols(.default = \"c\",\n                          year = \"i\",\n                          count = \"i\"))\n\n# Parquetã®èª­ã¿è¾¼ã¿\nread_parquet(\"who_longer.parquet\")\n\n\n\nãƒ¡ãƒªãƒƒãƒˆ3ï¼šCSVã‚ˆã‚Šãƒ“ãƒƒã‚°ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ãƒ»é›†è¨ˆã«é©ã—ã¦ã„ã‚‹\nCSVã¯ãƒ“ãƒƒã‚°ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«é©ã—ã¦ãŠã‚‰ãšï¼Œã“ã‚Œã¾ã§ã¯ï¼Œãƒ“ãƒƒã‚°ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ã«ã¯SQLã‚’ç”¨ã„ã‚‹ãªã©ã®ä½¿ã„åˆ†ã‘ãŒå¿…è¦ã§ã—ãŸï¼\nRã§ã¯ï¼Œdplyrï¼ˆdbplyrï¼‰ãƒ»DBIãªã©ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ç°¡å˜ã«SQLãŒä½¿ãˆã¾ã™ãŒï¼Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šãƒ»åˆ‡æ–­ãªã©ãŒå¿…è¦ãªSQLã¯ï¼ŒCSVã¨ä½¿ã„å‹æ‰‹ãŒç•°ãªã‚Šï¼Œåˆå­¦è€…ã«ã¨ã£ã¦ã¯ãƒãƒ¼ãƒ‰ãƒ«ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼\nã¾ãŸï¼Œï¼ˆã»ã¨ã‚“ã©ã®ï¼Ÿï¼‰SQLã¯è¡ŒæŒ‡å‘ã§ã‚ã‚‹ãŸã‚ï¼Œãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ ãƒ»æ›´æ–°ãƒ»å‰Šé™¤ãªã©ã«é©ã—ã¦ã„ã¾ã™ãŒï¼Œãƒ‡ãƒ¼ã‚¿åˆ†æã«ç”¨ã„ã‚‰ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜ãƒ»é›†è¨ˆã«ã¯åˆ—æŒ‡å‘ã§ã‚ã‚‹Parquetã®ã»ã†ãŒé©ã—ã¦ã„ã‚‹ã¨æ€ã‚ã‚Œã¾ã™ï¼\nCSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨ã„ã¦ãƒ“ãƒƒã‚°ãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆã™ã‚‹å ´åˆã«ã¯ï¼Œä¸€åº¦ï¼Œå…¨ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ¡ãƒ¢ãƒªã«ç§»ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼ãã®ãŸã‚ï¼Œãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã§ãƒ¡ãƒ¢ãƒªãŒé€¼è¿«ã™ã‚‹ãŠãã‚ŒãŒã‚ã‚Šã¾ã™ï¼\nParquetã§ã¯ï¼Œèª­ã¿è¾¼ã¿æ™‚ã«as_data_frame = FALSEã¨ã™ã‚‹ã“ã¨ã§ï¼ŒSQLã¨åŒæ§˜ã«ãƒ¡ãƒ¢ãƒªã«ãƒ‡ãƒ¼ã‚¿ã‚’ç§»ã™ã“ã¨ãªããƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»é›†è¨ˆãªã©ãŒå¯èƒ½ã§ã™ï¼\nã“ã“ã§ã¯ï¼Œæ—¥æœ¬ã®å¹´ãƒ»ç—‡ä¾‹åˆ¥ã®æ‚£è€…æ•°ã‚’è¨ˆç®—ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼dplyrã®filter() ãƒ»group_by() ãƒ»summarise() ãªã©ã‚’ä½¿ã£ã¦åŠ¹ç‡çš„ã«ã‚¯ã‚¨ãƒªã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼æœ€å¾Œã«collect() ã‚’è¡Œãˆã°ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’å‡ºåŠ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼\n\nread_parquet(\"who_longer.parquet\",\n             as_data_frame = FALSE) |> \n  filter(country == \"Japan\",\n         !is.na(count)) |> \n  group_by(country, year, diagnosis) |> \n  summarise(count = sum(count),\n            .groups = \"drop\") |> \n  collect()\n\n# A tibble: 33 Ã— 4\n   country  year diagnosis count\n   <chr>   <int> <chr>     <int>\n 1 Japan    1995 sp        14367\n 2 Japan    1996 sp        12867\n 3 Japan    1997 sp        13571\n 4 Japan    1998 sp        11935\n 5 Japan    1999 sp        12909\n 6 Japan    2000 sp        11853\n 7 Japan    2001 sp        11408\n 8 Japan    2002 sp        10807\n 9 Japan    2003 sp        10843\n10 Japan    2004 sp        10471\n# â€¦ with 23 more rows\n\n\n\n\nãƒ¡ãƒªãƒƒãƒˆ4ï¼šè¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãªã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’æ‰±ãˆã‚‹\nParquetã¯åˆ—æŒ‡å‘ã§ã‚ã‚‹ãŸã‚ï¼Œè¡ŒæŒ‡å‘ã§ã‚ã‚‹SQLã¨é•ã„ï¼Œãƒ‡ãƒ¼ã‚¿ã®è¿½åŠ ãƒ»æ›´æ–°ãƒ»å‰Šé™¤ãªã©ã«é©ã—ã¦ã„ã¾ã›ã‚“ï¼ã—ã‹ã—ï¼ŒParquetã§ã¯ï¼Œè¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãªã‚‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®èª­ã¿è¾¼ã¿ãŒç°¡å˜ã«è¡Œãˆã‚‹ãŸã‚ï¼Œã“ã®ã‚ˆã†ãªãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚’ç°¡å˜ã«è§£æ±ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼\nã“ã“ã§ã¯ï¼Œwho_longerã‚’å¹´é½¢éšç´šåˆ¥ã«åˆ†å‰²ã—ãŸParquetãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ ¼ç´ã—ãŸ\"who_longer_byage\" ãƒ•ã‚©ãƒ«ãƒ€ã‚’ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦ç”¨ã„ã¾ã—ã‚‡ã†ï¼\nopen_dataset(\"who_longer_byage\") ã¨ã™ã‚‹ã“ã¨ã§ï¼Œè¤‡æ•°ã®Parquetãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚€ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšï¼Œã•ãã»ã©ã¨åŒæ§˜ã®ãƒ‡ãƒ¼ã‚¿é›†è¨ˆã‚’ç°¡å˜ã«è¡Œã†ã“ã¨ãŒã§ãã¾ã™ï¼\n\n\nã‚³ãƒ¼ãƒ‰\ndir_create(\"who_longer_byage\")\nwho_longer |> \n  group_by(age) |> \n  group_walk(~ .x |> \n               write_parquet(str_glue(\"who_longer_byage/who_longer_{.y$age}.parquet\")),\n  .keep = TRUE)\n\n\n\nopen_dataset(\"who_longer_byage\") |> \n  filter(country == \"Japan\",\n         !is.na(count)) |> \n  group_by(country, year, diagnosis) |> \n  summarise(count = sum(count),\n            .groups = \"drop\") |> \n  collect()\n\n# A tibble: 33 Ã— 4\n   country  year diagnosis count\n   <chr>   <int> <chr>     <int>\n 1 Japan    1995 sp        14367\n 2 Japan    1996 sp        12867\n 3 Japan    1997 sp        13571\n 4 Japan    1998 sp        11935\n 5 Japan    1999 sp        12909\n 6 Japan    2000 sp        11853\n 7 Japan    2001 sp        11408\n 8 Japan    2002 sp        10807\n 9 Japan    2003 sp        10843\n10 Japan    2004 sp        10471\n# â€¦ with 23 more rows\n\n\n\n\nãƒ¡ãƒªãƒƒãƒˆ5ï¼šRãƒ»Pythoné–“ã§ã®ãƒ‡ãƒ¼ã‚¿ã®ã‚„ã‚Šå–ã‚Šã«é©ã—ã¦ã„ã‚‹\nPythonã®pandasãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯Parquetã®èª­ã¿æ›¸ãã«å¯¾å¿œã—ã¦ã„ã‚‹ãŸã‚ï¼ŒParquetã¯ï¼ŒRãƒ»Pythoné–“ã§ã®ãƒ‡ãƒ¼ã‚¿ã®ã‚„ã‚Šå–ã‚Šã«ã‚‚é©ã—ã¦ã„ã¾ã™ï¼\nRã§ä½œæˆã—ãŸ'who_longer.parquet' ã‚’pandasã§èª­ã¿è¾¼ã‚“ã§ã¿ã¾ã—ã‚‡ã†ï¼\n\nimport pandas as pd\n\npd.read_parquet('who_longer.parquet')\n\n            country iso2 iso3  year diagnosis gender   age   count\n0       Afghanistan   AF  AFG  1980        sp      m   014     NaN\n1       Afghanistan   AF  AFG  1980        sp      m  1524     NaN\n2       Afghanistan   AF  AFG  1980        sp      m  2534     NaN\n3       Afghanistan   AF  AFG  1980        sp      m  3544     NaN\n4       Afghanistan   AF  AFG  1980        sp      m  4554     NaN\n...             ...  ...  ...   ...       ...    ...   ...     ...\n405435     Zimbabwe   ZW  ZWE  2013       rel      f  2534  4649.0\n405436     Zimbabwe   ZW  ZWE  2013       rel      f  3544  3526.0\n405437     Zimbabwe   ZW  ZWE  2013       rel      f  4554  1453.0\n405438     Zimbabwe   ZW  ZWE  2013       rel      f  5564   811.0\n405439     Zimbabwe   ZW  ZWE  2013       rel      f    65   725.0\n\n[405440 rows x 8 columns]"
  },
  {
    "objectID": "posts/use-parquet-instead-of-csv-ja/use-parquet-instead-of-csv-ja.html#ã¾ã¨ã‚",
    "href": "posts/use-parquet-instead-of-csv-ja/use-parquet-instead-of-csv-ja.html#ã¾ã¨ã‚",
    "title": "ğŸ—¾CSVã®ä»£ã‚ã‚Šã«Parquetã‚’ä½¿ã£ã¦ã¿ã‚ˆã†",
    "section": "ã¾ã¨ã‚",
    "text": "ã¾ã¨ã‚\nã“ã“ã¾ã§ï¼ŒRãƒ»Pythonã§åˆ©ç”¨å¯èƒ½ãªParquetã®ãƒ¡ãƒªãƒƒãƒˆã‚’ç´¹ä»‹ã—ã¾ã—ãŸï¼Parquetã¯ï¼Œè¿‘å¹´ï¼Œãƒ‡ãƒ¼ã‚¿åˆ†æã§æ™®åŠã—ã¦ã„ã‚‹tidy dataã®ä¿å­˜ãƒ»é›†è¨ˆã«é©ã—ã¦ã„ã¾ã™ï¼\nã¾ãŸï¼Œæœ€è¿‘ã§ã¯ï¼Œåœ°ç†ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ãˆã‚‹sfãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ‡ãƒ¼ã‚¿ã‚’parquetã¨ã—ã¦ä¿å­˜ã§ãã‚‹sfarrowãªã©ã‚‚ç™»å ´ã—ã¦ã„ã¾ã™ï¼\nCSVã®ä»£ã‚ã‚Šã«Parquetã‚’ç”¨ã„ã‚‹ã“ã¨ã§ãƒ‡ãƒ¼ã‚¿åˆ†æãŒã•ã‚‰ã«ç°¡å˜ã«ãªã‚‹ã“ã¨ãŒæœŸå¾…ã•ã‚Œã¾ã™ï¼"
  },
  {
    "objectID": "posts/call-e-stat-api-in-r/call-e-stat-api-in-r.html",
    "href": "posts/call-e-stat-api-in-r/call-e-stat-api-in-r.html",
    "title": "Rã§æ—¥æœ¬ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹ç‡çš„ã«å–å¾—ã—ã‚ˆã†ï¼ˆe-Stat APIã¨jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ï¼‰",
    "section": "",
    "text": "ã“ã®è¨˜äº‹ã¯ã€ŒR Advent Calendar 2022ã€ã®12æ—¥ç›®ã®è¨˜äº‹ã§ã™ï¼\næ˜¨å¹´ï¼Œæ—¥æœ¬ã§æ”¿åºœçµ±è¨ˆã®æ•´å‚™ãŒå§‹ã¾ã£ã¦ã‹ã‚‰150å¹´ã‚’è¿ãˆã¾ã—ãŸï¼ˆå¹³æˆãƒ»ä»¤å’Œã®çµ±è¨ˆå¹´è¡¨ï¼‰ï¼æœ€è¿‘ã§ã¯ï¼Œæ”¿åºœçµ±è¨ˆã®ç·åˆçª“å£ï¼ˆe-Statï¼‰ã§ï¼Œæ§˜ã€…ãªæ”¿åºœçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’é–²è¦§ãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼\ne-Statã«ã¯ï¼Œä¾¿åˆ©ãªAPIæ©Ÿèƒ½ã‚‚æä¾›ã•ã‚Œã¦ã„ã¾ã™ï¼ˆåˆ©ç”¨ã‚¬ã‚¤ãƒ‰ã¯ã“ã¡ã‚‰ï¼ã‚ã‚‰ã‹ã˜ã‚åˆ©ç”¨è¦ç´„ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼APIæ©Ÿèƒ½ã‚’åˆ©ç”¨ã™ã‚‹éš›ã¯ï¼Œäº‹å‰ã«ãƒ¦ãƒ¼ã‚¶ç™»éŒ²ã‚’è¡Œã£ã¦ãã ã•ã„ï¼‰ï¼\nã“ã®è¨˜äº‹ã§ã¯ï¼ŒRã®jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦ï¼Œe-Stat APIã‚’åŠ¹ç‡çš„ã«ç”¨ã„ã‚‹æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ï¼"
  },
  {
    "objectID": "posts/call-e-stat-api-in-r/call-e-stat-api-in-r.html#e-statã®ä½¿ã„æ–¹",
    "href": "posts/call-e-stat-api-in-r/call-e-stat-api-in-r.html#e-statã®ä½¿ã„æ–¹",
    "title": "Rã§æ—¥æœ¬ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹ç‡çš„ã«å–å¾—ã™ã‚‹ï¼ˆe-Stat APIï¼‰",
    "section": "e-Statã®ä½¿ã„æ–¹",
    "text": "e-Statã®ä½¿ã„æ–¹\n\n\nappId <- keyring::key_get(\"estat-api\")\n\n\nlibrary(tidyverse)\nlibrary(jpstat)\n\n\nsleep_2015 <- estat(appId, \"https://www.e-stat.go.jp/dbview?sid=0003224282\")\nsleep_2015\n\n# â˜ tab:   è¡¨ç« é …ç›®     [2] <code, name, level, unit>\n# â˜ cat01: å¹´é½¢éšç´š     [7] <code, name, level, parentCode>\n# â˜ cat02: ç¡çœ ã®è³ª     [8] <code, name, level, parentCode>\n# â˜ cat03: æ€§åˆ¥         [3] <code, name, level, parentCode>\n# â˜ cat04: å¹³å‡ç¡çœ æ™‚é–“ [6] <code, name, level, parentCode>\n# â˜ time:  æ™‚é–“è»¸(å¹´æ¬¡) [1] <code, name, level>\n# \n# Please `activate()`.\n\n\n\nsleep_2015 |> \n  activate(tab) |> \n  filter(name == \"äººæ•°\") |> \n  \n  activate(cat01)\n\n# â˜ tab:   è¡¨ç« é …ç›®     [1] <code, name, level, unit>\n# â˜’ cat01: å¹´é½¢éšç´š     [7] <code, name, level, parentCode>\n# â˜ cat02: ç¡çœ ã®è³ª     [8] <code, name, level, parentCode>\n# â˜ cat03: æ€§åˆ¥         [3] <code, name, level, parentCode>\n# â˜ cat04: å¹³å‡ç¡çœ æ™‚é–“ [6] <code, name, level, parentCode>\n# â˜ time:  æ™‚é–“è»¸(å¹´æ¬¡) [1] <code, name, level>\n# \n# A tibble: 7 Ã— 4\n  code  name      level parentCode\n  <chr> <chr>     <chr> <chr>     \n1 100   ç·æ•°      1     <NA>      \n2 160   20æ­³-29æ­³ 2     100       \n3 170   30æ­³-39æ­³ 2     100       \n4 180   40æ­³-49æ­³ 2     100       \n5 190   50æ­³-59æ­³ 2     100       \n6 210   60æ­³-69æ­³ 2     100       \n7 220   70æ­³ä»¥ä¸Š  2     100"
  },
  {
    "objectID": "posts/call-e-stat-api-in-r/call-e-stat-api-in-r.html#e-statã«ã¤ã„ã¦",
    "href": "posts/call-e-stat-api-in-r/call-e-stat-api-in-r.html#e-statã«ã¤ã„ã¦",
    "title": "Rã§æ—¥æœ¬ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹ç‡çš„ã«å–å¾—ã—ã‚ˆã†ï¼ˆe-Stat APIã¨jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ï¼‰",
    "section": "e-Statã«ã¤ã„ã¦",
    "text": "e-Statã«ã¤ã„ã¦\ne-Statã«ã¯ï¼Œæ§˜ã€…ãªæ”¿åºœçµ±è¨ˆã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒæ•´ç†ã•ã‚Œã¦ã„ã¾ã™ãŒï¼Œã“ã“ã§ã¯ï¼Œ2015å¹´å›½æ°‘å¥åº·ãƒ»æ „é¤Šèª¿æŸ»ã®èª¿æŸ»çµæœã‹ã‚‰ç¡çœ æ™‚é–“ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼\nãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’é–‹ãã¨ä»¥ä¸‹ã®ã‚ˆã†ã«çµ±è¨ˆè¡¨ãŒè¡¨ç¤ºã•ã‚Œï¼Œå³ä¸Šã®ã€Œãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ãƒœã‚¿ãƒ³ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼\n\n\n\ne-Statãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼šçµ±è¨ˆè¡¨è¡¨ç¤ºç”»é¢\n\n\nç”»é¢å·¦ä¸Šã®ã€Œè¡¨ç¤ºé …ç›®é¸æŠã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ï¼Œè¡¨ç¤ºã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®é …ç›®ï¼ˆå¹´é½¢éšç´šãƒ»æ€§åˆ¥ãªã©ï¼‰ã‚’é¸æŠã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼\n\n\n\ne-Statãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼šè¡¨ç¤ºé …ç›®é¸æŠç”»é¢\n\n\nãŸã¨ãˆã°ï¼Œå¹´é½¢éšç´šã‚’é¸æŠã—ãŸã„å ´åˆã¯ï¼Œå¹´é½¢éšç´šã®ã€Œé …ç›®ã‚’é¸æŠã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªç”»é¢ã§å¹´é½¢éšç´šã‚’é¸æŠã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼\n\n\n\ne-Statãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼šè¡¨ç¤ºé …ç›®ã®è¨­å®šç”»é¢\n\n\nè¡¨ç¤ºé …ç›®ã‚’é¸æŠã—ãŸå¾Œã«ï¼Œã€Œãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ï¼Œé¸æŠã—ãŸé …ç›®ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼\nã“ã®ã‚ˆã†ã«ï¼Œe-Statã§ã¯ï¼Œç°¡å˜ã«ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ã—ã‹ã—ï¼Œãƒ‡ãƒ¼ã‚¿å–å¾—ä½œæ¥­ã®å†ç¾æ€§ã‚’é«˜ã‚ãŸã‚Šï¼Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ç”¨ã„ãŸãƒ‡ãƒ¼ã‚¿æŠ½å‡ºãƒ»å–å¾—ã®åŠ¹ç‡åŒ–ã‚’è¡Œã£ãŸã‚Šã—ãŸã„å ´åˆã¯ï¼Œe-Stat APIã‚’ç”¨ã„ã‚‹ã®ãŒãŠã™ã™ã‚ã§ã™ï¼"
  },
  {
    "objectID": "posts/call-e-stat-api-in-r/call-e-stat-api-in-r.html#jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§e-stat-apiã‚’ä½¿ã†",
    "href": "posts/call-e-stat-api-in-r/call-e-stat-api-in-r.html#jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§e-stat-apiã‚’ä½¿ã†",
    "title": "Rã§æ—¥æœ¬ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹ç‡çš„ã«å–å¾—ã—ã‚ˆã†ï¼ˆe-Stat APIã¨jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ï¼‰",
    "section": "jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§e-Stat APIã‚’ä½¿ã†",
    "text": "jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§e-Stat APIã‚’ä½¿ã†\nä¸Šã§èª¬æ˜ã—ãŸe-Statã§ã®ãƒ‡ãƒ¼ã‚¿ã®æŠ½å‡ºãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’e-Stat APIã§è¡Œã†ãŸã‚ã«ã¯ï¼Œä»¥ä¸‹ã®ã‚ˆã†ãªã‚¹ãƒ†ãƒƒãƒ—ã‚’è¸ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼\n\nãƒ¡ã‚¿æƒ…å ±å–å¾—ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®šï¼šè¡¨ç¤ºé …ç›®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ãƒ»é¸æŠï¼Œé¸æŠé …ç›®ã«å¯¾å¿œã™ã‚‹APIãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®š\nçµ±è¨ˆãƒ‡ãƒ¼ã‚¿å–å¾—ï¼šé¸æŠã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ãƒ»è¡¨ãƒ‡ãƒ¼ã‚¿ã«æ•´å½¢ã™ã‚‹\n\njpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ï¼Œã“ã‚Œã‚‰ã®ä¸€é€£ã®ä½œæ¥­ã‚’Rä¸Šã§åŠ¹ç‡çš„ã«è¡Œã†ãŸã‚é–‹ç™ºã•ã‚ŒãŸã‚‚ã®ã§ã™1ï¼jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ï¼ŒCRANã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼\nã“ã“ã§ã¯ï¼Œå¹´é½¢éšç´šåˆ¥ã®ç¡çœ æ™‚é–“ã‚’ã‚°ãƒ©ãƒ•åŒ–ã™ã‚‹ã“ã¨ã‚’ç›®æ¨™ã¨ã—ã¦ï¼Œã•ãã»ã©å–ã‚Šä¸Šã’ãŸç¡çœ æ™‚é–“ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆ2015å¹´ï¼‰ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼ã¾ãšï¼Œå¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã¿ã¾ã™ï¼\n\ninstall.packages(\"jpstat\")\n\n\nlibrary(tidyverse)\nlibrary(jpstat)\n\n\n\n\n\nã‚¹ãƒ†ãƒƒãƒ—1ï¼šãƒ¡ã‚¿æƒ…å ±ï¼ˆè¡¨ç¤ºé …ç›®ï¼‰ã‚’è¡¨ç¤ºãƒ»æŠ½å‡ºã™ã‚‹\ne-Stat APIã‚’ç”¨ã„ã‚‹ãŸã‚ã«ã¯ï¼Œäº‹å‰ã«ãƒ¦ãƒ¼ã‚¶ç™»éŒ²ã‚’è¡Œã„ï¼ŒappId ã¨å‘¼ã°ã‚Œã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³IDã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™2ï¼\nestat() é–¢æ•°ã«ï¼ŒappId ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®URLï¼ˆã¾ãŸã¯çµ±è¨ˆè¡¨IDï¼šstatsDataIdï¼‰ã‚’å…¥åŠ›ã™ã‚‹ã“ã¨ã§ãƒ¡ã‚¿æƒ…å ±ï¼ˆè¡¨ç¤ºé …ç›®ï¼‰ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™3ï¼\nã¯ã˜ã‚ã«ï¼Œãƒ¡ã‚¿æƒ…å ±ã®ã†ã¡ã€Œå¹´é½¢éšç´šï¼ˆcat01ï¼‰ã€ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼ˆcat01ã¯APIä¸Šã§ã®åˆ†é¡åã§ã™ï¼‰ï¼activate() é–¢æ•°ã«ã‚ˆã‚Šãƒ¡ã‚¿æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ã•ã‚‰ã«ï¼Œfilter() é–¢æ•°ã«ã‚ˆã‚Šé …ç›®ã‚’é¸æŠã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ã“ã“ã§ã¯ï¼Œå¹´é½¢éšç´šåˆ¥ãƒ‡ãƒ¼ã‚¿ã®ã¿ãŒå¿…è¦ã§ã‚ã‚‹ãŸã‚ï¼Œã€Œç·æ•°ã€ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™4ï¼\nãƒ‘ã‚¤ãƒ—æ¼”ç®—å­|> ã‚’ä½¿ã†ã“ã¨ã§ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ï¼Œcat01ä»¥å¤–ã®ãƒ¡ã‚¿æƒ…å ±ã®ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºã‚’ç¶šã‘ã¦è¡Œã†ã“ã¨ãŒã§ãã¾ã™ï¼\n\n# ã”è‡ªèº«ã®appIdã«ç½®ãæ›ãˆã¦ãã ã•ã„\nappId <- \"Your appId\"\n\n\nestat_sleep_2015 <- estat(appId, \"https://www.e-stat.go.jp/dbview?sid=0003224282\")\n\n\n# ãƒ¡ã‚¿æƒ…å ±ã®é–²è¦§ãƒ»é¸æŠ\nestat_sleep_2015 |> \n  activate(cat01) |> \n  filter(name != \"ç·æ•°\")\n\n# â˜ tab:   è¡¨ç« é …ç›®     [2] <code, name, level, unit>\n# â˜’ cat01: å¹´é½¢éšç´š     [6] <code, name, level, parentCode>\n# â˜ cat02: ç¡çœ ã®è³ª     [8] <code, name, level, parentCode>\n# â˜ cat03: æ€§åˆ¥         [3] <code, name, level, parentCode>\n# â˜ cat04: å¹³å‡ç¡çœ æ™‚é–“ [6] <code, name, level, parentCode>\n# â˜ time:  æ™‚é–“è»¸(å¹´æ¬¡) [1] <code, name, level>\n# \n# A tibble: 6 Ã— 4\n  code  name      level parentCode\n  <chr> <chr>     <chr> <chr>     \n1 160   20æ­³-29æ­³ 2     100       \n2 170   30æ­³-39æ­³ 2     100       \n3 180   40æ­³-49æ­³ 2     100       \n4 190   50æ­³-59æ­³ 2     100       \n5 210   60æ­³-69æ­³ 2     100       \n6 220   70æ­³ä»¥ä¸Š  2     100       \n\n\n\nestat_sleep_2015_filtered <- estat_sleep_2015 |> \n  \n  # è¡¨ç« é …ç›®\n  activate(tab) |> \n  filter(name == \"äººæ•°\") |> \n  \n  # å¹´é½¢éšç´š\n  activate(cat01) |> \n  filter(name != \"ç·æ•°\") |> \n  \n  # ç¡çœ ã®è³ª\n  activate(cat02) |> \n  filter(name == \"ç·æ•°\") |> \n  \n  # æ€§åˆ¥\n  activate(cat03) |> \n  filter(name == \"ç·æ•°\")\n\n\n\nã‚¹ãƒ†ãƒƒãƒ—2ï¼šçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼‰ã™ã‚‹\nã“ã“ã§ã¯ï¼Œå¹´é½¢éšç´šãƒ»ç¡çœ æ™‚é–“åˆ¥ã®å›ç­”è€…æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\nãƒ‡ãƒ¼ã‚¿ã®æŠ½å‡ºå¾Œã«collect() ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã§çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆã¾ãŸï¼Œcollect()ã®nå¼•æ•°ã§ï¼Œå–å¾—ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®åˆ—ã‚’\"person\"ã¨åä»˜ã‘ã¦ã„ã¾ã™ï¼‰ï¼\nãŸã ã—ï¼Œç¾çŠ¶ã§ã¯ï¼Œå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿data_sleep_2015 ã«å¤šãã®åˆ—ãŒå­˜åœ¨ã™ã‚‹ãŸã‚ï¼Œåˆ†æã—ã¥ã‚‰ããªã£ã¦ã„ã¾ã™ï¼ã‚¹ãƒ†ãƒƒãƒ—Î±ã§ï¼Œãƒ‡ãƒ¼ã‚¿å–å¾—ã¨ãƒ‡ãƒ¼ã‚¿æ•´å½¢ã‚’åŒæ™‚ã«è¡Œã†æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ï¼\n\ndata_sleep_2015 <- estat_sleep_2015_filtered |> \n  \n  # ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»æ•°å€¤ã«å¤‰æ›\n  collect(n = \"person\") |> \n  mutate(person = parse_number(person))\n\nThe total number of data is 36.\n\nknitr::kable(head(data_sleep_2015, 10))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntab_code\ntab_name\ntab_level\ntab_unit\ncat01_code\ncat01_name\ncat01_level\ncat01_parentCode\ncat02_code\ncat02_name\ncat02_level\ncat02_parentCode\ncat03_code\ncat03_name\ncat03_level\ncat03_parentCode\ncat04_code\ncat04_name\ncat04_level\ncat04_parentCode\ntime_code\ntime_name\ntime_level\nperson\n\n\n\n\n100\näººæ•°\n\näºº\n160\n20æ­³-29æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n110\nï¼•æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n51\n\n\n100\näººæ•°\n\näºº\n160\n20æ­³-29æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n120\nï¼•æ™‚é–“ä»¥ä¸Šï¼–æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n192\n\n\n100\näººæ•°\n\näºº\n160\n20æ­³-29æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n130\nï¼–æ™‚é–“ä»¥ä¸Šï¼—æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n182\n\n\n100\näººæ•°\n\näºº\n160\n20æ­³-29æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n140\nï¼—æ™‚é–“ä»¥ä¸Šï¼˜æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n92\n\n\n100\näººæ•°\n\näºº\n160\n20æ­³-29æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n150\nï¼˜æ™‚é–“ä»¥ä¸Šï¼™æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n29\n\n\n100\näººæ•°\n\näºº\n160\n20æ­³-29æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n160\nï¼™æ™‚é–“ä»¥ä¸Š\n2\n100\n2015000000\n2015å¹´\n1\n7\n\n\n100\näººæ•°\n\näºº\n170\n30æ­³-39æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n110\nï¼•æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n68\n\n\n100\näººæ•°\n\näºº\n170\n30æ­³-39æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n120\nï¼•æ™‚é–“ä»¥ä¸Šï¼–æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n276\n\n\n100\näººæ•°\n\näºº\n170\n30æ­³-39æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n130\nï¼–æ™‚é–“ä»¥ä¸Šï¼—æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n303\n\n\n100\näººæ•°\n\näºº\n170\n30æ­³-39æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n140\nï¼—æ™‚é–“ä»¥ä¸Šï¼˜æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n152\n\n\n\n\n\n\n\nã‚¹ãƒ†ãƒƒãƒ—Î±ï¼šãƒ‡ãƒ¼ã‚¿å–å¾—ã¨ãƒ‡ãƒ¼ã‚¿æ•´å½¢ã‚’åŒæ™‚ã«è¡Œã†\njpstatã§e-Statã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã¨ï¼Œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åï¼ˆcat01ãªã©ï¼‰ã¨å„é …ç›®ã®åˆ—åï¼ˆcodeï¼Œ nameãªã©ï¼‰ã‹ã‚‰åˆ—ï¼ˆcat01_codeï¼Œcat01_nameãªã©ï¼‰ãŒä½œæˆã•ã‚Œã¾ã™ï¼\njpstatã§ã¯ï¼Œrekey() é–¢æ•°ã«ã‚ˆã‚Šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã‚’å¤‰æ›´ã—ãŸã‚Šï¼Œselect() é–¢æ•°ã§é …ç›®åˆ¥ã«åˆ—ã‚’é¸æŠã—ãŸã‚Šã™ã‚‹ã“ã¨ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ•´ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™5ï¼ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãã“ã¨ã§ï¼Œã™ã£ãã‚Šã¨ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼\n\ndata_sleep_2015 <- estat_sleep_2015 |> \n  activate(tab) |> \n  filter(name == \"äººæ•°\") |> \n  select() |> \n  \n  activate(cat01) |> \n  rekey(\"ageclass\") |> \n  filter(name != \"ç·æ•°\") |> \n  select(name) |> \n  \n  activate(cat02) |> \n  filter(name == \"ç·æ•°\") |> \n  select() |> \n  \n  activate(cat03) |> \n  filter(name == \"ç·æ•°\") |> \n  select() |> \n  \n  activate(cat04) |> \n  rekey(\"sleeptime\") |> \n  select(name) |> \n  \n  activate(time) |> \n  select() |> \n  \n  collect(n = \"person\") |> \n  mutate(person = parse_number(person))\n\nThe total number of data is 36.\n\nknitr::kable(head(data_sleep_2015, 10))\n\n\n\n\nageclass_name\nsleeptime_name\nperson\n\n\n\n\n20æ­³-29æ­³\nï¼•æ™‚é–“æœªæº€\n51\n\n\n20æ­³-29æ­³\nï¼•æ™‚é–“ä»¥ä¸Šï¼–æ™‚é–“æœªæº€\n192\n\n\n20æ­³-29æ­³\nï¼–æ™‚é–“ä»¥ä¸Šï¼—æ™‚é–“æœªæº€\n182\n\n\n20æ­³-29æ­³\nï¼—æ™‚é–“ä»¥ä¸Šï¼˜æ™‚é–“æœªæº€\n92\n\n\n20æ­³-29æ­³\nï¼˜æ™‚é–“ä»¥ä¸Šï¼™æ™‚é–“æœªæº€\n29\n\n\n20æ­³-29æ­³\nï¼™æ™‚é–“ä»¥ä¸Š\n7\n\n\n30æ­³-39æ­³\nï¼•æ™‚é–“æœªæº€\n68\n\n\n30æ­³-39æ­³\nï¼•æ™‚é–“ä»¥ä¸Šï¼–æ™‚é–“æœªæº€\n276\n\n\n30æ­³-39æ­³\nï¼–æ™‚é–“ä»¥ä¸Šï¼—æ™‚é–“æœªæº€\n303\n\n\n30æ­³-39æ­³\nï¼—æ™‚é–“ä»¥ä¸Šï¼˜æ™‚é–“æœªæº€\n152\n\n\n\n\n\n\n\nãŠã¾ã‘ï¼šå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã®ã‚°ãƒ©ãƒ•åŒ–\næœ€å¾Œã«ï¼Œå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚°ãƒ©ãƒ•åŒ–ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\n\ndata_sleep_2015 |> \n  mutate(ageclass_name = as_factor(ageclass_name),\n         sleeptime_name = as_factor(sleeptime_name)) |> \n  group_by(ageclass_name) |> \n  mutate(prop = person / sum(person)) |> \n  ungroup() |> \n  ggplot(aes(ageclass_name, prop,\n             fill = fct_rev(sleeptime_name))) +\n  geom_col() +\n  geom_text(aes(label = if_else(prop > 0.05,\n                                scales::label_percent(accuracy = 0.1)(prop),\n                                \"\")),\n            position = position_stack(vjust = 0.5)) +\n  scale_x_discrete(\"å¹´é½¢éšç´š\") +\n  scale_y_continuous(\"å‰²åˆ\", \n                     labels = scales::label_percent(accuracy = 1)) +\n  scale_fill_brewer(\"ç¡çœ æ™‚é–“\",\n                    palette = \"Spectral\")"
  },
  {
    "objectID": "posts/call-e-stat-api-in-r/call-e-stat-api-in-r.html#jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§e-stat-apiã‚’ä½¿ã†æ–¹æ³•",
    "href": "posts/call-e-stat-api-in-r/call-e-stat-api-in-r.html#jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§e-stat-apiã‚’ä½¿ã†æ–¹æ³•",
    "title": "Rã§æ—¥æœ¬ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹ç‡çš„ã«å–å¾—ã—ã‚ˆã†ï¼ˆe-Stat APIã¨jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ï¼‰",
    "section": "jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§e-Stat APIã‚’ä½¿ã†æ–¹æ³•",
    "text": "jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§e-Stat APIã‚’ä½¿ã†æ–¹æ³•\ne-Stat APIã§ã¯ï¼Œæ§˜ã€…ãªæ©Ÿèƒ½ãŒæä¾›ã•ã‚Œã¦ã„ã¾ã™ï¼ˆAPIä»•æ§˜ï¼‰ï¼\nä¸Šã§èª¬æ˜ã—ãŸe-Statã§ã®ãƒ‡ãƒ¼ã‚¿ã®æŠ½å‡ºãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’e-Stat APIã§è¡Œã†ãŸã‚ã«ã¯ï¼Œä»¥ä¸‹ã®ã‚ˆã†ãªã‚¹ãƒ†ãƒƒãƒ—ã‚’è¸ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼\n\nãƒ¡ã‚¿æƒ…å ±å–å¾—ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®šï¼šè¡¨ç¤ºé …ç›®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ãƒ»é¸æŠï¼Œé¸æŠé …ç›®ã«å¯¾å¿œã™ã‚‹APIãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®š\nçµ±è¨ˆãƒ‡ãƒ¼ã‚¿å–å¾—ï¼šé¸æŠã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ãƒ»è¡¨ãƒ‡ãƒ¼ã‚¿ã«æ•´å½¢ã™ã‚‹\n\njpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ï¼Œã“ã‚Œã‚‰ã®ä¸€é€£ã®ä½œæ¥­ã‚’Rä¸Šã§åŠ¹ç‡çš„ã«è¡Œã†ãŸã‚é–‹ç™ºã•ã‚ŒãŸã‚‚ã®ã§ã™ï¼jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ï¼ŒCRANã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼\nã“ã“ã§ã¯ï¼Œå¹´é½¢éšç´šåˆ¥ã®ç¡çœ æ™‚é–“ã‚’ã‚°ãƒ©ãƒ•åŒ–ã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã¦ï¼Œã•ãã»ã©å–ã‚Šä¸Šã’ãŸç¡çœ æ™‚é–“ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆ2015å¹´ï¼‰ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼ã¾ãšï¼Œå¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã¿ã¾ã™ï¼\n\ninstall.packages(\"jpstat\")\n\n\nlibrary(tidyverse)\nlibrary(jpstat)\n\n\n\n\ne-Stat APIã‚’ç”¨ã„ã‚‹ãŸã‚ã«ã¯ï¼Œäº‹å‰ã«ãƒ¦ãƒ¼ã‚¶ç™»éŒ²ã‚’è¡Œã„ï¼ŒappId ã¨å‘¼ã°ã‚Œã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³IDã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼\n\nã‚¹ãƒ†ãƒƒãƒ—1ï¼šãƒ¡ã‚¿æƒ…å ±ï¼ˆè¡¨ç¤ºé …ç›®ï¼‰ã®å–å¾—\nestat() é–¢æ•°ã«ï¼ŒappId ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®URLï¼ˆã¾ãŸã¯çµ±è¨ˆè¡¨IDï¼šstatsDataIdï¼‰ã‚’å…¥åŠ›ã™ã‚‹ã“ã¨ã§ãƒ¡ã‚¿æƒ…å ±ï¼ˆè¡¨ç¤ºé …ç›®ï¼‰ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼\nã¯ã˜ã‚ã«ï¼Œãƒ¡ã‚¿æƒ…å ±ã®ã†ã¡ã€Œå¹´é½¢éšç´šï¼ˆcat01ï¼‰ã€ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼ˆcat01ã¯APIä¸Šã§ã®åˆ†é¡åã§ã™ï¼‰ï¼activate() é–¢æ•°ã«ã‚ˆã‚Šãƒ¡ã‚¿æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ã•ã‚‰ã«ï¼Œfilter() é–¢æ•°ã«ã‚ˆã‚Šé …ç›®ã‚’é¸æŠã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ã“ã“ã§ã¯ï¼Œå¹´é½¢éšç´šåˆ¥ãƒ‡ãƒ¼ã‚¿ã®ã¿ãŒå¿…è¦ã§ã‚ã‚‹ãŸã‚ï¼Œã€Œç·æ•°ã€ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™1ï¼\n\n# ã”è‡ªèº«ã®appIdã«ç½®ãæ›ãˆã¦ãã ã•ã„\nappId <- \"Your appId\"\n\n\nestat_sleep_2015 <- estat(appId, \"https://www.e-stat.go.jp/dbview?sid=0003224282\")\n\n\n# ãƒ¡ã‚¿æƒ…å ±ã®é–²è¦§ãƒ»é¸æŠ\nestat_sleep_2015 |> \n  activate(cat01) |> \n  filter(name != \"ç·æ•°\")\n\n# â˜ tab:   è¡¨ç« é …ç›®     [2] <code, name, level, unit>\n# â˜’ cat01: å¹´é½¢éšç´š     [6] <code, name, level, parentCode>\n# â˜ cat02: ç¡çœ ã®è³ª     [8] <code, name, level, parentCode>\n# â˜ cat03: æ€§åˆ¥         [3] <code, name, level, parentCode>\n# â˜ cat04: å¹³å‡ç¡çœ æ™‚é–“ [6] <code, name, level, parentCode>\n# â˜ time:  æ™‚é–“è»¸(å¹´æ¬¡) [1] <code, name, level>\n# \n# A tibble: 6 Ã— 4\n  code  name      level parentCode\n  <chr> <chr>     <chr> <chr>     \n1 160   20æ­³-29æ­³ 2     100       \n2 170   30æ­³-39æ­³ 2     100       \n3 180   40æ­³-49æ­³ 2     100       \n4 190   50æ­³-59æ­³ 2     100       \n5 210   60æ­³-69æ­³ 2     100       \n6 220   70æ­³ä»¥ä¸Š  2     100       \n\n\n\n\nã‚¹ãƒ†ãƒƒãƒ—2ï¼šçµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã®å–å¾—ï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼‰\nãƒ‡ãƒ¼ã‚¿æŠ½å‡ºã¯ï¼Œãƒ‘ã‚¤ãƒ—æ¼”ç®—å­|> ã‚’ä½¿ã†ã“ã¨ã§ï¼Œç¶šã‘ã¦è¡Œã†ã“ã¨ãŒã§ãã¾ã™ï¼ãƒ‡ãƒ¼ã‚¿ã®æŠ½å‡ºå¾Œã«collect() ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã§çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ˆã¾ãŸï¼Œcollect()ã®nå¼•æ•°ã§ï¼Œå–å¾—ã™ã‚‹ãƒ‡ãƒ¼ã‚¿åˆ—ã‚’åä»˜ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼‰ï¼ãŸã ã—ï¼Œå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿data_sleep_2015 ã«ã¯å¤šãã®åˆ—ãŒå­˜åœ¨ã—ï¼Œåˆ†æã—ã¥ã‚‰ããªã£ã¦ã„ã¾ã™ï¼ä»¥ä¸‹ã§ã¯ï¼Œãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»ãƒ‡ãƒ¼ã‚¿æ•´å½¢ã‚’åŒæ™‚ã«è¡Œã†æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ï¼\n\ndata_sleep_2015 <- estat_sleep_2015 |> \n  \n  # è¡¨ç« é …ç›®\n  activate(tab) |> \n  filter(name == \"äººæ•°\") |> \n  \n  # å¹´é½¢éšç´š\n  activate(cat01) |> \n  filter(name != \"ç·æ•°\") |> \n  \n  # ç¡çœ ã®è³ª\n  activate(cat02) |> \n  filter(name == \"ç·æ•°\") |> \n  \n  # æ€§åˆ¥\n  activate(cat03) |> \n  filter(name == \"ç·æ•°\") |> \n  \n  # ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»æ•°å€¤ã«å¤‰æ›\n  collect(n = \"person\") |> \n  mutate(person = parse_number(person))\n\nThe total number of data is 36.\n\nknitr::kable(head(data_sleep_2015, 10))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntab_code\ntab_name\ntab_level\ntab_unit\ncat01_code\ncat01_name\ncat01_level\ncat01_parentCode\ncat02_code\ncat02_name\ncat02_level\ncat02_parentCode\ncat03_code\ncat03_name\ncat03_level\ncat03_parentCode\ncat04_code\ncat04_name\ncat04_level\ncat04_parentCode\ntime_code\ntime_name\ntime_level\nperson\n\n\n\n\n100\näººæ•°\n\näºº\n160\n20æ­³-29æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n110\nï¼•æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n51\n\n\n100\näººæ•°\n\näºº\n160\n20æ­³-29æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n120\nï¼•æ™‚é–“ä»¥ä¸Šï¼–æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n192\n\n\n100\näººæ•°\n\näºº\n160\n20æ­³-29æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n130\nï¼–æ™‚é–“ä»¥ä¸Šï¼—æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n182\n\n\n100\näººæ•°\n\näºº\n160\n20æ­³-29æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n140\nï¼—æ™‚é–“ä»¥ä¸Šï¼˜æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n92\n\n\n100\näººæ•°\n\näºº\n160\n20æ­³-29æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n150\nï¼˜æ™‚é–“ä»¥ä¸Šï¼™æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n29\n\n\n100\näººæ•°\n\näºº\n160\n20æ­³-29æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n160\nï¼™æ™‚é–“ä»¥ä¸Š\n2\n100\n2015000000\n2015å¹´\n1\n7\n\n\n100\näººæ•°\n\näºº\n170\n30æ­³-39æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n110\nï¼•æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n68\n\n\n100\näººæ•°\n\näºº\n170\n30æ­³-39æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n120\nï¼•æ™‚é–“ä»¥ä¸Šï¼–æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n276\n\n\n100\näººæ•°\n\näºº\n170\n30æ­³-39æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n130\nï¼–æ™‚é–“ä»¥ä¸Šï¼—æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n303\n\n\n100\näººæ•°\n\näºº\n170\n30æ­³-39æ­³\n2\n100\n100\nç·æ•°\n1\nNA\n100\nç·æ•°\n1\nNA\n140\nï¼—æ™‚é–“ä»¥ä¸Šï¼˜æ™‚é–“æœªæº€\n2\n100\n2015000000\n2015å¹´\n1\n152\n\n\n\n\n\n\nãƒ‡ãƒ¼ã‚¿æ•´å½¢ã‚’è¡Œã†æ–¹æ³•\njpstatã§e-Statã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã¨ï¼Œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åï¼ˆcat01ãªã©ï¼‰ã¨å„é …ç›®ã®åˆ—åï¼ˆcodeï¼Œ nameãªã©ï¼‰ã‹ã‚‰åˆ—ï¼ˆcat01_codeï¼Œcat01_nameãªã©ï¼‰ãŒä½œæˆã•ã‚Œã¾ã™ï¼\njpstatã§ã¯ï¼Œrekey() é–¢æ•°ã«ã‚ˆã‚Šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åã‚’å¤‰æ›´ã—ãŸã‚Šï¼Œselect() é–¢æ•°ã§é …ç›®åˆ¥ã«åˆ—ã‚’é¸æŠã—ãŸã‚Šã™ã‚‹ã“ã¨ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ•´ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™2ï¼ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãã“ã¨ã§ï¼Œã™ã£ãã‚Šã¨ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸï¼\n\ndata_sleep_2015 <- estat_sleep_2015 |> \n  activate(tab) |> \n  filter(name == \"äººæ•°\") |> \n  select() |> \n  \n  activate(cat01) |> \n  rekey(\"ageclass\") |> \n  filter(name != \"ç·æ•°\") |> \n  select(name) |> \n  \n  activate(cat02) |> \n  filter(name == \"ç·æ•°\") |> \n  select() |> \n  \n  activate(cat03) |> \n  filter(name == \"ç·æ•°\") |> \n  select() |> \n  \n  activate(cat04) |> \n  rekey(\"sleeptime\") |> \n  select(name) |> \n  \n  activate(time) |> \n  select() |> \n  \n  collect(n = \"person\") |> \n  mutate(person = parse_number(person))\n\nThe total number of data is 36.\n\nknitr::kable(head(data_sleep_2015, 10))\n\n\n\n\nageclass_name\nsleeptime_name\nperson\n\n\n\n\n20æ­³-29æ­³\nï¼•æ™‚é–“æœªæº€\n51\n\n\n20æ­³-29æ­³\nï¼•æ™‚é–“ä»¥ä¸Šï¼–æ™‚é–“æœªæº€\n192\n\n\n20æ­³-29æ­³\nï¼–æ™‚é–“ä»¥ä¸Šï¼—æ™‚é–“æœªæº€\n182\n\n\n20æ­³-29æ­³\nï¼—æ™‚é–“ä»¥ä¸Šï¼˜æ™‚é–“æœªæº€\n92\n\n\n20æ­³-29æ­³\nï¼˜æ™‚é–“ä»¥ä¸Šï¼™æ™‚é–“æœªæº€\n29\n\n\n20æ­³-29æ­³\nï¼™æ™‚é–“ä»¥ä¸Š\n7\n\n\n30æ­³-39æ­³\nï¼•æ™‚é–“æœªæº€\n68\n\n\n30æ­³-39æ­³\nï¼•æ™‚é–“ä»¥ä¸Šï¼–æ™‚é–“æœªæº€\n276\n\n\n30æ­³-39æ­³\nï¼–æ™‚é–“ä»¥ä¸Šï¼—æ™‚é–“æœªæº€\n303\n\n\n30æ­³-39æ­³\nï¼—æ™‚é–“ä»¥ä¸Šï¼˜æ™‚é–“æœªæº€\n152\n\n\n\n\n\n\n\n\nå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã®ã‚°ãƒ©ãƒ•åŒ–ã®ä¾‹\næœ€å¾Œã«ï¼Œå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚°ãƒ©ãƒ•åŒ–ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼\n\ndata_sleep_2015 |> \n  group_by(ageclass_name) |> \n  mutate(prop = person / sum(person)) |> \n  ungroup() |> \n  ggplot(aes(ageclass_name, prop,\n             fill = fct_rev(sleeptime_name))) +\n  geom_col() +\n  geom_text(aes(label = if_else(prop > 0.05,\n                                scales::label_percent(accuracy = 0.1)(prop),\n                                \"\")),\n            position = position_stack(vjust = 0.5)) +\n  scale_x_discrete(\"å¹´é½¢éšç´š\") +\n  scale_y_continuous(\"å‰²åˆ\", \n                     labels = scales::label_percent(accuracy = 1)) +\n  scale_fill_brewer(\"ç¡çœ æ™‚é–“\",\n                    palette = \"Spectral\")"
  },
  {
    "objectID": "posts/call-e-stat-api-in-r/call-e-stat-api-in-r.html#ã¾ã¨ã‚",
    "href": "posts/call-e-stat-api-in-r/call-e-stat-api-in-r.html#ã¾ã¨ã‚",
    "title": "Rã§æ—¥æœ¬ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹ç‡çš„ã«å–å¾—ã—ã‚ˆã†ï¼ˆe-Stat APIã¨jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ï¼‰",
    "section": "ã¾ã¨ã‚",
    "text": "ã¾ã¨ã‚\næœ¬è¨˜äº‹ã§ã¯ï¼Œe-Stat APIã¨jpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§æ—¥æœ¬ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹ç‡çš„ã«å–å¾—ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ç´¹ä»‹ã—ã¾ã—ãŸï¼\nRã§çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ã§ï¼Œä½œæ¥­ã®å†ç¾æ€§ã‚„åŠ¹ç‡æ€§ã‚’é«˜ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ï¼ã¾ãŸï¼Œjpstatãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†ã“ã¨ã§ï¼Œãƒ‡ãƒ¼ã‚¿å–å¾—ã¨ãƒ‡ãƒ¼ã‚¿æ•´å½¢ã‚’åŒæ™‚ã«è¡Œã†ã“ã¨ãŒã§ãã‚‹ãŸã‚ä¾¿åˆ©ã§ã™ï¼ã¿ãªã•ã‚“ã‚‚ãœã²ä½¿ã£ã¦ã¿ã¦ãã ã•ã„ï¼"
  }
]