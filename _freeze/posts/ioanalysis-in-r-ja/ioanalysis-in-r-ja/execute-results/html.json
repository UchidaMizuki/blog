{
  "hash": "d0f8c73b6a28ecdefca8096c2f46ddcb",
  "result": {
    "markdown": "---\ntitle: \"ğŸ—¾Rã§ç”£æ¥­é€£é–¢åˆ†æ\"\nlang: ja\ndate: \"2022-05-31\"\ncategories: [ioanalysis, R, Japanese]\n---\n\n\nç”£æ¥­é€£é–¢åˆ†æã¯ï¼ŒçµŒæ¸ˆæ³¢åŠåŠ¹æœã®ç®—å‡ºã«åºƒãç”¨ã„ã‚‰ã‚Œã¦ã„ã‚‹åˆ†ææ‰‹æ³•ã§ã™ï¼\næ—¥æœ¬ã§ã¯ï¼Œå›½ã‚„éƒ½é“åºœçœŒã«ã‚ˆã£ã¦ï¼Œç´„5å¹´ã«1åº¦ï¼Œç”£æ¥­é€£é–¢è¡¨ã¨å‘¼ã°ã‚Œã‚‹çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ãŒ\nä½œæˆãƒ»å…¬é–‹ã•ã‚Œã¦ãŠã‚Šï¼Œç”£æ¥­é€£é–¢åˆ†æã«ãŠã‘ã‚‹åŸºç¤ãƒ‡ãƒ¼ã‚¿ã¨ãªã£ã¦ã„ã¾ã™ï¼\n\nã“ã‚Œã¾ã§ï¼Œç”£æ¥­é€£é–¢åˆ†æã§ã¯ï¼ŒExcelãƒ»VBAãŒç”¨ã„ã‚‰ã‚Œã‚‹ã“ã¨ãŒå¤šã‹ã£ãŸã‚ˆã†ã§ã™ï¼\n\nä¸€æ–¹ã§ï¼Œè¿‘å¹´ã¯ï¼ŒPythonãƒ»Rãƒ»Juliaãªã©ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®æ™®åŠãŒé€²ã‚“ã§ã„ã¾ã™ï¼\nã“ã‚Œã‚‰ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã¯ä»¥ä¸‹ã®ã‚ˆã†ãªç‰¹é•·ã‚’æŒã£ã¦ã„ã¾ã™ï¼\n\n- ç„¡æ–™ã§åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã‚‹\n- ä½œæ¥­ã®å†ç¾æ€§ãŒé«˜ã¾ã‚ŠãƒŸã‚¹ãŒä¿®æ­£ã—ã‚„ã™ã„ãƒ»ä»–è€…ãŒãƒŸã‚¹ã«æ°—ã¥ãã‚„ã™ã„\n- é«˜åº¦ãªåˆ†ææ‰‹æ³•ãŒç°¡å˜ã«åˆ©ç”¨ã§ãã‚‹\n\nãã®ãŸã‚ä»Šå¾Œã¯ï¼Œç”£æ¥­é€£é–¢åˆ†æã«ãŠã„ã¦ã‚‚ï¼Œã“ã‚Œã‚‰ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã®åˆ©ç”¨ãŒ\né€²ã‚€ã®ã§ã¯ãªã„ã‹ã¨æ€ã‚ã‚Œã¾ã™ï¼\n\nã“ã“ã§ã¯ï¼ŒRã‚’ç”¨ã„ã¦ç”£æ¥­é€£é–¢åˆ†æã‚’è¡Œã„ã¾ã™ï¼\nRã§ã¯è¿‘å¹´ï¼Œtidyverseãªã©ãƒ¢ãƒ€ãƒ³ãªãƒ‡ãƒ¼ã‚¿åˆ†æã‚’è¡Œã†ãŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒ\nå¤šãæä¾›ã•ã‚Œã¦ãŠã‚Šï¼Œãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°åˆå¿ƒè€…ã§ã‚‚ç¿’å¾—ã—ã‚„ã™ã„è¨€èªã§ã‚ã‚‹ã¨æ€ã„ã¾ã™ï¼\n\nç”£æ¥­é€£é–¢è¡¨ã¨ã—ã¦ï¼Œe-Statã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§å…¬é–‹ã•ã‚Œã¦ã„ã‚‹æ—¥æœ¬ï¼ˆå›½ï¼‰ã®\n2013å¹´ãƒ»13éƒ¨é–€ç”£æ¥­é€£é–¢è¡¨ã‚’ç”¨ã„ã¾ã™ï¼\nã“ã“ã§ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ï¼Œ\n[ã“ã¡ã‚‰](https://github.com/UchidaMizuki/blog-ioanalysis-in-r)\nã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ï¼\n\n\n\n## åˆ†æã®æµã‚Œ\n\nä¸€èˆ¬çš„ãªç”£æ¥­é€£é–¢åˆ†æã®æµã‚Œã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼\n\n1. ç”£æ¥­é€£é–¢è¡¨ã®æ•´å½¢\n1. æŠ•å…¥ä¿‚æ•°è¡Œåˆ—ã®ç®—å‡º\n1. ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ã®ç®—å‡º\n1. çµŒæ¸ˆæ³¢åŠåŠ¹æœã®ç®—å‡º\n\nä»¥ä¸Šã®æµã‚Œã«æ²¿ã£ã¦ï¼ŒRã«ã‚ˆã‚‹ç”£æ¥­é€£é–¢åˆ†æã®è¨ˆç®—ä¾‹ã‚’ç¤ºã—ã¾ã™ï¼\n\n\n\n## Rã«ã‚ˆã‚‹ç”£æ¥­é€£é–¢åˆ†æ\n### ç”£æ¥­é€£é–¢è¡¨ã®æ•´å½¢\n\nã“ã“ã§ã¯ï¼Œ\n[ã“ã¡ã‚‰](https://github.com/UchidaMizuki/blog-ioanalysis-in-r)\nã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹æ—¥æœ¬ã®2011å¹´ã®3éƒ¨é–€è¡¨ï¼ˆ`iotable_3sector_2011_wider.csv`ï¼‰ã‚’\nä½¿ç”¨ã—ã¾ã™ï¼\n\nã“ã¡ã‚‰ã®è¡¨ã¯ï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ï¼Œæ—¥æœ¬ã®2011å¹´ã®13éƒ¨é–€è¡¨ã‚ˆã‚Šä½œæˆã—ãŸã‚‚ã®ã§ã™ï¼\n\n* 13éƒ¨é–€ã®ç”£æ¥­åˆ†é¡ã‚’ç¬¬1æ¬¡ãƒ»ç¬¬2æ¬¡ãƒ»ç¬¬3æ¬¡ç”£æ¥­ã«é›†è¨ˆ\n* ä»˜åŠ ä¾¡å€¤éƒ¨é–€ã¯1éƒ¨é–€ã«é›†è¨ˆ\n* æœ€çµ‚éœ€è¦éƒ¨é–€ã¯åŸŸå†…æœ€çµ‚éœ€è¦ï¼ˆ`finaldemand`ï¼‰ãƒ»è¼¸å‡ºï¼ˆ`export`ï¼‰ãƒ»è¼¸å…¥ï¼ˆ`import`ï¼‰ã®3éƒ¨é–€ã«é›†è¨ˆ\n\nç”£æ¥­é€£é–¢è¡¨ã®ãƒ‡ãƒ¼ã‚¿å½¢å¼ã¯ï¼Œe-Statã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§æä¾›ã•ã‚Œã¦ã„ã‚‹è¡¨ãªã©ã‚’é™¤ã„ã¦ï¼Œ\nè¡Œã«æŠ•å…¥éƒ¨é–€ï¼ˆ`input`ï¼‰ãƒ»åˆ—ã«ç”£å‡ºéƒ¨é–€ï¼ˆ`output`ï¼‰ã‚’æŒã¤ã€Œæ¨ªé•·ãƒ‡ãƒ¼ã‚¿ã€ã§ã‚ã‚‹ã“ã¨ãŒå¤šã„ã¨æ€ã‚ã‚Œã¾ã™ï¼\n\nã“ã“ã§ã‚‚ï¼Œä»¥ä¸‹ã®é€šã‚Šï¼Œã¾ãšã¯æ¨ªé•·ã®ç”£æ¥­é€£é–¢è¡¨ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã™ï¼\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\niotable_wider <- read_csv(\"iotable_3sector_2011_wider.csv\",\n                          col_types = cols(.default = \"c\")) |> \n  mutate(across(-1, parse_number))\n\nknitr::kable(iotable_wider)\n```\n\n::: {.cell-output-display}\n|input                    | industry/01_primary| industry/02_secondary| industry/03_tertiary| finaldemand/04_finaldemand| export/05_export| import/06_import|\n|:------------------------|-------------------:|---------------------:|--------------------:|--------------------------:|----------------:|----------------:|\n|industry/01_primary      |             1456611|               7850628|              1373767|                    3869875|            47890|         -2562809|\n|industry/02_secondary    |             2715710|             161897553|             62841827|                  132924323|         54473273|        -71673715|\n|industry/03_tertiary     |             2025270|              66811645|            155796589|                  352324555|         16423417|         -8921553|\n|valueadded/04_valueadded |             5838371|             106619145|            364447740|                         NA|               NA|               NA|\n:::\n:::\n\n\nãƒ‡ãƒ¼ã‚¿åˆ†æã«ãŠã„ã¦ã¯ï¼Œã€Œæ¨ªé•·ãƒ‡ãƒ¼ã‚¿ã€ã‚ˆã‚Šã‚‚ï¼Œä»¥ä¸‹ã®ã‚ˆã†ãªã€Œç¸¦é•·ãƒ‡ãƒ¼ã‚¿ã€ã®ã»ã†ãŒï¼Œ\nåˆ†æã—ã‚„ã™ã„å ´åˆãŒå¤šãã‚ã‚Šã¾ã™ï¼\nã“ã“ã§ã‚‚ï¼Œæ¨ªé•·ã®ç”£æ¥­é€£é–¢è¡¨ã‚’ã€Œç¸¦é•·ãƒ‡ãƒ¼ã‚¿ã€ã«å¤‰æ›ã—ã¾ã™ï¼\n\n\n::: {.cell}\n\n```{.r .cell-code}\niotable <- iotable_wider |>\n  separate(input, c(\"input_type\", \"input_name\"),\n           sep = \"/\") |>\n  pivot_longer(!c(input_type, input_name),\n               names_to = c(\"output_type\", \"output_name\"),\n               names_sep = \"/\",\n               values_to = \"value_M\") |>\n  drop_na(value_M)\n\nknitr::kable(iotable)\n```\n\n::: {.cell-output-display}\n|input_type |input_name    |output_type |output_name    |   value_M|\n|:----------|:-------------|:-----------|:--------------|---------:|\n|industry   |01_primary    |industry    |01_primary     |   1456611|\n|industry   |01_primary    |industry    |02_secondary   |   7850628|\n|industry   |01_primary    |industry    |03_tertiary    |   1373767|\n|industry   |01_primary    |finaldemand |04_finaldemand |   3869875|\n|industry   |01_primary    |export      |05_export      |     47890|\n|industry   |01_primary    |import      |06_import      |  -2562809|\n|industry   |02_secondary  |industry    |01_primary     |   2715710|\n|industry   |02_secondary  |industry    |02_secondary   | 161897553|\n|industry   |02_secondary  |industry    |03_tertiary    |  62841827|\n|industry   |02_secondary  |finaldemand |04_finaldemand | 132924323|\n|industry   |02_secondary  |export      |05_export      |  54473273|\n|industry   |02_secondary  |import      |06_import      | -71673715|\n|industry   |03_tertiary   |industry    |01_primary     |   2025270|\n|industry   |03_tertiary   |industry    |02_secondary   |  66811645|\n|industry   |03_tertiary   |industry    |03_tertiary    | 155796589|\n|industry   |03_tertiary   |finaldemand |04_finaldemand | 352324555|\n|industry   |03_tertiary   |export      |05_export      |  16423417|\n|industry   |03_tertiary   |import      |06_import      |  -8921553|\n|valueadded |04_valueadded |industry    |01_primary     |   5838371|\n|valueadded |04_valueadded |industry    |02_secondary   | 106619145|\n|valueadded |04_valueadded |industry    |03_tertiary    | 364447740|\n:::\n:::\n\n\nä¸Šã§æ§‹ç¯‰ã—ãŸè¡¨ãƒ‡ãƒ¼ã‚¿ã¯ï¼Œå„è¡Œã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãªã©ãŒå®¹æ˜“ã«ã§ãã‚‹ä¸€æ–¹ã§ï¼Œ\nç”£æ¥­é€£é–¢åˆ†æã«ç”¨ã„ã‚‰ã‚Œã‚‹è¡Œåˆ—è¨ˆç®—ãªã©ã«é©ã—ã¦ã„ã¾ã›ã‚“ï¼\n\nãã“ã§ï¼Œè¡¨ãƒ‡ãƒ¼ã‚¿ã®è¦‹ãŸç›®ã®ã¾ã¾è¡Œåˆ—è¨ˆç®—ã‚’è¡Œãˆã‚‹dibbleãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ã¾ã™ï¼\nä»¥ä¸‹ã§ã¯ï¼Œç”£æ¥­é€£é–¢è¡¨ã‚’dibbleã«å¤‰æ›ã—ã¦ã„ã¾ã™ï¼\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dibble)\n\niotable <- iotable |>\n  dibble_by(input = c(input_type, input_name),\n            output = c(output_type, output_name),\n            .names_sep = \"_\")\n\niotable\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A dibble:   24 x 1\n# Dimensions: input [4], output [6]\n# Measures:   value_M\n   input$type $name        output$type $name            value_M\n   <chr>      <chr>        <chr>       <chr>              <dbl>\n 1 industry   01_primary   industry    01_primary       1456611\n 2 industry   01_primary   industry    02_secondary     7850628\n 3 industry   01_primary   industry    03_tertiary      1373767\n 4 industry   01_primary   finaldemand 04_finaldemand   3869875\n 5 industry   01_primary   export      05_export          47890\n 6 industry   01_primary   import      06_import       -2562809\n 7 industry   02_secondary industry    01_primary       2715710\n 8 industry   02_secondary industry    02_secondary   161897553\n 9 industry   02_secondary industry    03_tertiary     62841827\n10 industry   02_secondary finaldemand 04_finaldemand 132924323\n# â€¦ with 14 more rows\n```\n:::\n:::\n\n\n### æŠ•å…¥ä¿‚æ•°è¡Œåˆ—ã®ç®—å‡º\n\næŠ•å…¥ä¿‚æ•°ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã‚‹ï¼\n\n\n$$\na_{ij}=\\frac{x_{ij}}{X_j}\n$$\n\n::: {.cell}\n\n```{.r .cell-code}\ntotal_input <- iotable |>\n  filter(output$type == \"industry\") |>\n  apply(\"output\", sum)\n\ninterindustry <- iotable |>\n  filter(input$type == \"industry\",\n         output$type == \"industry\")\n\ninputcoeff <- broadcast(interindustry / total_input,\n                        c(\"input\", \"output\"))\n\ninputcoeff\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A dibble:   9\n# Dimensions: input [3], output [3]\n  input$type $name        output$type $name              .\n  <chr>      <chr>        <chr>       <chr>          <dbl>\n1 industry   01_primary   industry    01_primary   0.121  \n2 industry   01_primary   industry    02_secondary 0.0229 \n3 industry   01_primary   industry    03_tertiary  0.00235\n4 industry   02_secondary industry    01_primary   0.226  \n5 industry   02_secondary industry    02_secondary 0.472  \n6 industry   02_secondary industry    03_tertiary  0.108  \n7 industry   03_tertiary  industry    01_primary   0.168  \n8 industry   03_tertiary  industry    02_secondary 0.195  \n9 industry   03_tertiary  industry    03_tertiary  0.267  \n```\n:::\n:::\n\n\n\n\n### ãƒ¬ã‚ªãƒ³ãƒã‚§ãƒ•é€†è¡Œåˆ—ã®ç®—å‡º\n\n\n$$\n[I-(I-M)A]^{-1}\n$$\n\n::: {.cell}\n\n```{.r .cell-code}\nlocaloutput <- iotable |>\n  filter(input$type == \"industry\",\n         !output$type %in% c(\"export\", \"import\")) |>\n  apply(\"input\", sum)\n\nimport <- iotable |>\n  filter(input$type == \"industry\",\n         output$type == \"import\") |>\n  apply(\"input\", sum)\nimport <- -import\n\nimportcoeff <- import / localoutput\n\nI <- eye(inputcoeff)\nM <- importcoeff\nA <- inputcoeff\n\nleontiefinv <- broadcast(I - (1 - M) * A,\n                         c(\"input\", \"output\")) |>\n  solve()\n\nleontiefinv\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A dibble:   9\n# Dimensions: output [3], input [3]\n  output$type $name        input$type $name              .\n  <chr>       <chr>        <chr>      <chr>          <dbl>\n1 industry    01_primary   industry   01_primary   1.12   \n2 industry    01_primary   industry   02_secondary 0.0361 \n3 industry    01_primary   industry   03_tertiary  0.00716\n4 industry    02_secondary industry   01_primary   0.374  \n5 industry    02_secondary industry   02_secondary 1.68   \n6 industry    02_secondary industry   03_tertiary  0.197  \n7 industry    03_tertiary  industry   01_primary   0.348  \n8 industry    03_tertiary  industry   02_secondary 0.445  \n9 industry    03_tertiary  industry   03_tertiary  1.41   \n```\n:::\n:::\n\n\n### çµŒæ¸ˆæ³¢åŠåŠ¹æœã®ç®—å‡º\n\nTODO\n\n## ã¾ã¨ã‚\n\nTODO",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}