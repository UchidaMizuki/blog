{
  "hash": "49249b415c68947a9565b1c87e122ae3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"TODO\"\nlang: ja\ncategories: [Japanese]\ndraft: true\nformat:\n  html:\n    df-print: paged\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nset.seed(1234)\nn <- 1e3\n\nalpha <- 8\n\ndata <- tibble(x = rnorm(n),\n               mu = exp(-4 + 2 * x),\n               lambda = rgamma(n, alpha, alpha / mu),\n               y = rpois(n, lambda))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- MASS::glm.nb(y ~ x,\n                      data = data)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nMASS::glm.nb(formula = y ~ x, data = data, init.theta = 8.76520407, \n    link = log)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  -3.9569     0.2226  -17.78   <2e-16 ***\nx             1.9066     0.1175   16.22   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Negative Binomial(8.7652) family taken to be 1)\n\n    Null deviance: 617.72  on 999  degrees of freedom\nResidual deviance: 253.48  on 998  degrees of freedom\nAIC: 428.12\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  8.8 \n          Std. Err.:  12.1 \n\n 2 x log-likelihood:  -422.116 \n```\n\n\n:::\n\n```{.r .cell-code}\ndata_smoothed <- data |> \n  mutate(mu_pred = predict(model, type = \"response\"),\n         lambda_smoothed = mu_pred / (mu_pred + model$theta) * (y + model$theta))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_smoothed |> \n  select(lambda, y, lambda_smoothed) |> \n  pivot_longer(c(y, lambda_smoothed),\n               names_to = \"pred_type\",\n               names_transform = list(pred_type = as_factor),\n               values_to = \"lambda_pred\") |> \n  ggplot(aes(lambda, lambda_pred)) +\n  geom_point() +\n  geom_abline(color = \"red\") +\n  scale_x_continuous(trans = \"log1p\") +\n  scale_y_continuous(trans = \"log1p\") +\n  facet_wrap(~ pred_type)\n```\n\n::: {.cell-output-display}\n![](draft_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# data |> \n#   ggplot(aes(y, lambda)) + \n#   geom_point()\n# \n# data |> \n#   ggplot(aes(lambda_pred, lambda)) +\n#   geom_point()\n```\n:::\n",
    "supporting": [
      "draft_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}